ðŸ”­ OTLP/HTTP receiver listening on http://localhost:4318

ðŸ”­ Received traces: 1 ResourceSpans
Resource attributes: {
  "service.instance.id": "2a40665ba2e149cc8dbf71e3021164af",
  "telemetry.sdk.language": "python",
  "telemetry.sdk.name": "opentelemetry",
  "telemetry.sdk.version": "1.34.1",
  "service.name": "lunary-tool-check",
  "process.pid": 19696,
  "process.runtime.name": "cpython",
  "process.runtime.version": "3.13.5",
  "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
  "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
}
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events

ðŸ”§ Fixing parent-child relationships...
Before fix:
- llm f4f70071-11ba-4d62-8a4a-3f323b1dcbc6 parent: 68dc12a6-98f1-40c5-83be-5de56ec0b5eb
- llm f4f70071-11ba-4d62-8a4a-3f323b1dcbc6 parent: 68dc12a6-98f1-40c5-83be-5de56ec0b5eb
- tool 06a2113f-39c5-4f6e-be6e-32aafb423fb9 parent: 83332e41-c325-4f7e-8f58-32cc70a401ca
- tool 06a2113f-39c5-4f6e-be6e-32aafb423fb9 parent: 83332e41-c325-4f7e-8f58-32cc70a401ca
- llm 37f5e138-83d5-42e5-80da-8b27ce3574c3 parent: 2f528c23-5fc9-44ca-a0bd-3a41b23787d5
- llm 37f5e138-83d5-42e5-80da-8b27ce3574c3 parent: 2f528c23-5fc9-44ca-a0bd-3a41b23787d5
- agent ae529b70-657e-4c12-a981-53b481d68e19 parent: none
- agent ae529b70-657e-4c12-a981-53b481d68e19 parent: none

After fix:
- llm f4f70071-11ba-4d62-8a4a-3f323b1dcbc6 parent: ae529b70-657e-4c12-a981-53b481d68e19
- llm f4f70071-11ba-4d62-8a4a-3f323b1dcbc6 parent: ae529b70-657e-4c12-a981-53b481d68e19
- tool 06a2113f-39c5-4f6e-be6e-32aafb423fb9 parent: ae529b70-657e-4c12-a981-53b481d68e19
- tool 06a2113f-39c5-4f6e-be6e-32aafb423fb9 parent: ae529b70-657e-4c12-a981-53b481d68e19
- llm 37f5e138-83d5-42e5-80da-8b27ce3574c3 parent: ae529b70-657e-4c12-a981-53b481d68e19
- llm 37f5e138-83d5-42e5-80da-8b27ce3574c3 parent: ae529b70-657e-4c12-a981-53b481d68e19
- agent ae529b70-657e-4c12-a981-53b481d68e19 parent: none
- agent ae529b70-657e-4c12-a981-53b481d68e19 parent: none

ðŸ“¥ Forwarding 8 events to backend
Events: [
  {
    "type": "llm",
    "event": "start",
    "runId": "f4f70071-11ba-4d62-8a4a-3f323b1dcbc6",
    "parentRunId": "ae529b70-657e-4c12-a981-53b481d68e19",
    "timestamp": "2025-06-25T23:54:25.214Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"calculate\", \"description\": \"Calculate a mathematical expression\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"expression\": {\"type\": \"string\"}}, \"required\": [\"expression\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a calculator assistant.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Calculate 10 * 5 + 3\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_qjT1DIDh5FW0bCN0ZhdC0V8X\", \"type\": \"function\", \"function\": {\"name\": \"calculate\", \"arguments\": \"{\\\"expression\\\":\\\"10 * 5 + 3\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2a40665ba2e149cc8dbf71e3021164af",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-tool-check",
      "process.pid": 19696,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 56,
      "completion": 19
    },
    "input": [
      {
        "role": "system",
        "content": "You are a calculator assistant."
      },
      {
        "role": "user",
        "content": "Calculate 10 * 5 + 3"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "f4f70071-11ba-4d62-8a4a-3f323b1dcbc6",
    "parentRunId": "ae529b70-657e-4c12-a981-53b481d68e19",
    "timestamp": "2025-06-25T23:54:26.352Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"calculate\", \"description\": \"Calculate a mathematical expression\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"expression\": {\"type\": \"string\"}}, \"required\": [\"expression\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a calculator assistant.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Calculate 10 * 5 + 3\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_qjT1DIDh5FW0bCN0ZhdC0V8X\", \"type\": \"function\", \"function\": {\"name\": \"calculate\", \"arguments\": \"{\\\"expression\\\":\\\"10 * 5 + 3\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2a40665ba2e149cc8dbf71e3021164af",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-tool-check",
      "process.pid": 19696,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1138.103
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 56,
      "completion": 19
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_qjT1DIDh5FW0bCN0ZhdC0V8X",
            "type": "function",
            "function": {
              "name": "calculate",
              "arguments": "{\"expression\":\"10 * 5 + 3\"}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "06a2113f-39c5-4f6e-be6e-32aafb423fb9",
    "parentRunId": "ae529b70-657e-4c12-a981-53b481d68e19",
    "timestamp": "2025-06-25T23:54:26.354Z",
    "metadata": {
      "toolName": "calculate",
      "toolCallId": "call_qjT1DIDh5FW0bCN0ZhdC0V8X",
      "tool_arguments": "{\"expression\":\"10 * 5 + 3\"}",
      "logfire_msg": "running tool: calculate",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "2a40665ba2e149cc8dbf71e3021164af",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-tool-check",
      "process.pid": 19696,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "expression": "10 * 5 + 3"
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "06a2113f-39c5-4f6e-be6e-32aafb423fb9",
    "parentRunId": "ae529b70-657e-4c12-a981-53b481d68e19",
    "timestamp": "2025-06-25T23:54:26.356Z",
    "metadata": {
      "toolName": "calculate",
      "toolCallId": "call_qjT1DIDh5FW0bCN0ZhdC0V8X",
      "tool_arguments": "{\"expression\":\"10 * 5 + 3\"}",
      "logfire_msg": "running tool: calculate",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "2a40665ba2e149cc8dbf71e3021164af",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-tool-check",
      "process.pid": 19696,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1.351
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "37f5e138-83d5-42e5-80da-8b27ce3574c3",
    "parentRunId": "ae529b70-657e-4c12-a981-53b481d68e19",
    "timestamp": "2025-06-25T23:54:26.357Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"calculate\", \"description\": \"Calculate a mathematical expression\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"expression\": {\"type\": \"string\"}}, \"required\": [\"expression\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a calculator assistant.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Calculate 10 * 5 + 3\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_qjT1DIDh5FW0bCN0ZhdC0V8X\", \"type\": \"function\", \"function\": {\"name\": \"calculate\", \"arguments\": \"{\\\"expression\\\":\\\"10 * 5 + 3\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"The result is 53\", \"role\": \"tool\", \"id\": \"call_qjT1DIDh5FW0bCN0ZhdC0V8X\", \"name\": \"calculate\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"The result of the expression \\\\(10 \\\\times 5 + 3\\\\) is 53.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2a40665ba2e149cc8dbf71e3021164af",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-tool-check",
      "process.pid": 19696,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 87,
      "completion": 21
    },
    "input": [
      {
        "role": "system",
        "content": "You are a calculator assistant."
      },
      {
        "role": "user",
        "content": "Calculate 10 * 5 + 3"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "37f5e138-83d5-42e5-80da-8b27ce3574c3",
    "parentRunId": "ae529b70-657e-4c12-a981-53b481d68e19",
    "timestamp": "2025-06-25T23:54:28.433Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"calculate\", \"description\": \"Calculate a mathematical expression\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"expression\": {\"type\": \"string\"}}, \"required\": [\"expression\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a calculator assistant.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Calculate 10 * 5 + 3\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_qjT1DIDh5FW0bCN0ZhdC0V8X\", \"type\": \"function\", \"function\": {\"name\": \"calculate\", \"arguments\": \"{\\\"expression\\\":\\\"10 * 5 + 3\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"The result is 53\", \"role\": \"tool\", \"id\": \"call_qjT1DIDh5FW0bCN0ZhdC0V8X\", \"name\": \"calculate\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"The result of the expression \\\\(10 \\\\times 5 + 3\\\\) is 53.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2a40665ba2e149cc8dbf71e3021164af",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-tool-check",
      "process.pid": 19696,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2075.926
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 87,
      "completion": 21
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "content": "The result of the expression \\(10 \\times 5 + 3\\) is 53."
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "ae529b70-657e-4c12-a981-53b481d68e19",
    "timestamp": "2025-06-25T23:54:25.211Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "agent",
      "logfire_msg": "agent run",
      "logfire_span_type": "span",
      "final_result": "The result of the expression \\(10 \\times 5 + 3\\) is 53.",
      "all_messages_events": "[{\"content\": \"You are a calculator assistant.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Calculate 10 * 5 + 3\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_qjT1DIDh5FW0bCN0ZhdC0V8X\", \"type\": \"function\", \"function\": {\"name\": \"calculate\", \"arguments\": \"{\\\"expression\\\":\\\"10 * 5 + 3\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"The result is 53\", \"role\": \"tool\", \"id\": \"call_qjT1DIDh5FW0bCN0ZhdC0V8X\", \"name\": \"calculate\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"The result of the expression \\\\(10 \\\\times 5 + 3\\\\) is 53.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "2a40665ba2e149cc8dbf71e3021164af",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-tool-check",
      "process.pid": 19696,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 143,
      "completion": 40
    },
    "input": [
      {
        "role": "system",
        "content": "You are a calculator assistant."
      },
      {
        "role": "user",
        "content": "Calculate 10 * 5 + 3"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "ae529b70-657e-4c12-a981-53b481d68e19",
    "timestamp": "2025-06-25T23:54:28.434Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "agent",
      "logfire_msg": "agent run",
      "logfire_span_type": "span",
      "final_result": "The result of the expression \\(10 \\times 5 + 3\\) is 53.",
      "all_messages_events": "[{\"content\": \"You are a calculator assistant.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Calculate 10 * 5 + 3\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_qjT1DIDh5FW0bCN0ZhdC0V8X\", \"type\": \"function\", \"function\": {\"name\": \"calculate\", \"arguments\": \"{\\\"expression\\\":\\\"10 * 5 + 3\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"The result is 53\", \"role\": \"tool\", \"id\": \"call_qjT1DIDh5FW0bCN0ZhdC0V8X\", \"name\": \"calculate\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"The result of the expression \\\\(10 \\\\times 5 + 3\\\\) is 53.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "2a40665ba2e149cc8dbf71e3021164af",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-tool-check",
      "process.pid": 19696,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 3222.755
    },
    "tokensUsage": {
      "prompt": 143,
      "completion": 40
    },
    "output": "The result of the expression \\(10 \\times 5 + 3\\) is 53."
  }
]
Using project key: 07ff18c9-f052-4260-9e89-ea93fe9ba8c5
âœ… Successfully forwarded to backend
ðŸ“Š metrics: 1 ResourceMetrics

ðŸ”­ Received traces: 1 ResourceSpans
Resource attributes: {
  "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
  "telemetry.sdk.language": "python",
  "telemetry.sdk.name": "opentelemetry",
  "telemetry.sdk.version": "1.34.1",
  "service.name": "lunary-weather-agent",
  "process.pid": 21067,
  "process.runtime.name": "cpython",
  "process.runtime.version": "3.13.5",
  "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
  "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
}
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events

ðŸ”§ Fixing parent-child relationships...
Before fix:
- llm d188ad56-dc2d-40da-a5c0-5baba5c308dd parent: c93a7623-66ff-4801-8ae3-567787de1297
- llm d188ad56-dc2d-40da-a5c0-5baba5c308dd parent: c93a7623-66ff-4801-8ae3-567787de1297
- tool 6e00fd3d-1941-4e78-9524-fc86b66d838c parent: 7108e570-dcf7-4fda-8540-4efc8ab0027f
- tool 6e00fd3d-1941-4e78-9524-fc86b66d838c parent: 7108e570-dcf7-4fda-8540-4efc8ab0027f
- llm 9625e7f6-a65a-4562-830e-986c142ed2b9 parent: b9e16b29-7067-4584-94f9-07c9a114132c
- llm 9625e7f6-a65a-4562-830e-986c142ed2b9 parent: b9e16b29-7067-4584-94f9-07c9a114132c
- agent 1c554ef9-051c-4157-bfb2-dc79743a2f6b parent: none
- agent 1c554ef9-051c-4157-bfb2-dc79743a2f6b parent: none
- llm 9f7c9085-4d25-496c-b4c8-72c9597af3e4 parent: b6138438-ba3c-472b-a606-4b9fac88deb3
- llm 9f7c9085-4d25-496c-b4c8-72c9597af3e4 parent: b6138438-ba3c-472b-a606-4b9fac88deb3
- tool d2d9846e-1fb4-4575-8e14-1ce3bb68104d parent: 83764c2a-806f-4f1f-8f23-f43f457a7955
- tool d2d9846e-1fb4-4575-8e14-1ce3bb68104d parent: 83764c2a-806f-4f1f-8f23-f43f457a7955

After fix:
- llm d188ad56-dc2d-40da-a5c0-5baba5c308dd parent: 1c554ef9-051c-4157-bfb2-dc79743a2f6b
- llm d188ad56-dc2d-40da-a5c0-5baba5c308dd parent: 1c554ef9-051c-4157-bfb2-dc79743a2f6b
- tool 6e00fd3d-1941-4e78-9524-fc86b66d838c parent: 1c554ef9-051c-4157-bfb2-dc79743a2f6b
- tool 6e00fd3d-1941-4e78-9524-fc86b66d838c parent: 1c554ef9-051c-4157-bfb2-dc79743a2f6b
- llm 9625e7f6-a65a-4562-830e-986c142ed2b9 parent: 1c554ef9-051c-4157-bfb2-dc79743a2f6b
- llm 9625e7f6-a65a-4562-830e-986c142ed2b9 parent: 1c554ef9-051c-4157-bfb2-dc79743a2f6b
- agent 1c554ef9-051c-4157-bfb2-dc79743a2f6b parent: none
- agent 1c554ef9-051c-4157-bfb2-dc79743a2f6b parent: none
- llm 9f7c9085-4d25-496c-b4c8-72c9597af3e4 parent: 1c554ef9-051c-4157-bfb2-dc79743a2f6b
- llm 9f7c9085-4d25-496c-b4c8-72c9597af3e4 parent: 1c554ef9-051c-4157-bfb2-dc79743a2f6b
- tool d2d9846e-1fb4-4575-8e14-1ce3bb68104d parent: 1c554ef9-051c-4157-bfb2-dc79743a2f6b
- tool d2d9846e-1fb4-4575-8e14-1ce3bb68104d parent: 1c554ef9-051c-4157-bfb2-dc79743a2f6b

ðŸ“¥ Forwarding 12 events to backend
Events: [
  {
    "type": "llm",
    "event": "start",
    "runId": "d188ad56-dc2d-40da-a5c0-5baba5c308dd",
    "parentRunId": "1c554ef9-051c-4157-bfb2-dc79743a2f6b",
    "timestamp": "2025-06-26T08:04:50.112Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather like in New York?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zCcm4yjsZ09pIWaGzbcuzPWQ\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\":\\\"New York\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 127,
      "completion": 16
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the weather like in New York?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "d188ad56-dc2d-40da-a5c0-5baba5c308dd",
    "parentRunId": "1c554ef9-051c-4157-bfb2-dc79743a2f6b",
    "timestamp": "2025-06-26T08:04:51.387Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather like in New York?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zCcm4yjsZ09pIWaGzbcuzPWQ\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\":\\\"New York\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1274.767
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 127,
      "completion": 16
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_zCcm4yjsZ09pIWaGzbcuzPWQ",
            "type": "function",
            "function": {
              "name": "get_current_weather",
              "arguments": "{\"city\":\"New York\"}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "6e00fd3d-1941-4e78-9524-fc86b66d838c",
    "parentRunId": "1c554ef9-051c-4157-bfb2-dc79743a2f6b",
    "timestamp": "2025-06-26T08:04:51.389Z",
    "metadata": {
      "toolName": "get_current_weather",
      "toolCallId": "call_zCcm4yjsZ09pIWaGzbcuzPWQ",
      "tool_arguments": "{\"city\":\"New York\"}",
      "logfire_msg": "running tool: get_current_weather",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "city": "New York"
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "6e00fd3d-1941-4e78-9524-fc86b66d838c",
    "parentRunId": "1c554ef9-051c-4157-bfb2-dc79743a2f6b",
    "timestamp": "2025-06-26T08:04:51.390Z",
    "metadata": {
      "toolName": "get_current_weather",
      "toolCallId": "call_zCcm4yjsZ09pIWaGzbcuzPWQ",
      "tool_arguments": "{\"city\":\"New York\"}",
      "logfire_msg": "running tool: get_current_weather",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.99
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "9625e7f6-a65a-4562-830e-986c142ed2b9",
    "parentRunId": "1c554ef9-051c-4157-bfb2-dc79743a2f6b",
    "timestamp": "2025-06-26T08:04:51.391Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather like in New York?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zCcm4yjsZ09pIWaGzbcuzPWQ\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\":\\\"New York\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"New York\", \"temperature\": 72, \"condition\": \"Partly Cloudy\", \"humidity\": 65, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_zCcm4yjsZ09pIWaGzbcuzPWQ\", \"name\": \"get_current_weather\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"The current weather in New York is partly cloudy with a temperature of 72\\u00b0F and a humidity level of 65%.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 178,
      "completion": 25
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the weather like in New York?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "9625e7f6-a65a-4562-830e-986c142ed2b9",
    "parentRunId": "1c554ef9-051c-4157-bfb2-dc79743a2f6b",
    "timestamp": "2025-06-26T08:04:52.292Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather like in New York?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zCcm4yjsZ09pIWaGzbcuzPWQ\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\":\\\"New York\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"New York\", \"temperature\": 72, \"condition\": \"Partly Cloudy\", \"humidity\": 65, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_zCcm4yjsZ09pIWaGzbcuzPWQ\", \"name\": \"get_current_weather\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"The current weather in New York is partly cloudy with a temperature of 72\\u00b0F and a humidity level of 65%.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 900.709
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 178,
      "completion": 25
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "content": "The current weather in New York is partly cloudy with a temperature of 72Â°F and a humidity level of 65%."
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "1c554ef9-051c-4157-bfb2-dc79743a2f6b",
    "timestamp": "2025-06-26T08:04:50.111Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "The current weather in New York is partly cloudy with a temperature of 72Â°F and a humidity level of 65%.",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather like in New York?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zCcm4yjsZ09pIWaGzbcuzPWQ\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\":\\\"New York\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"New York\", \"temperature\": 72, \"condition\": \"Partly Cloudy\", \"humidity\": 65, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_zCcm4yjsZ09pIWaGzbcuzPWQ\", \"name\": \"get_current_weather\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"The current weather in New York is partly cloudy with a temperature of 72\\u00b0F and a humidity level of 65%.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 305,
      "completion": 41
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the weather like in New York?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "1c554ef9-051c-4157-bfb2-dc79743a2f6b",
    "timestamp": "2025-06-26T08:04:52.292Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "The current weather in New York is partly cloudy with a temperature of 72Â°F and a humidity level of 65%.",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather like in New York?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zCcm4yjsZ09pIWaGzbcuzPWQ\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\":\\\"New York\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"New York\", \"temperature\": 72, \"condition\": \"Partly Cloudy\", \"humidity\": 65, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_zCcm4yjsZ09pIWaGzbcuzPWQ\", \"name\": \"get_current_weather\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"The current weather in New York is partly cloudy with a temperature of 72\\u00b0F and a humidity level of 65%.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2181.704
    },
    "tokensUsage": {
      "prompt": 305,
      "completion": 41
    },
    "output": "The current weather in New York is partly cloudy with a temperature of 72Â°F and a humidity level of 65%."
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "9f7c9085-4d25-496c-b4c8-72c9597af3e4",
    "parentRunId": "1c554ef9-051c-4157-bfb2-dc79743a2f6b",
    "timestamp": "2025-06-26T08:04:52.295Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Compare the weather between London and Tokyo\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_omes1y8gaRaHh7lq8jCBpujx\", \"type\": \"function\", \"function\": {\"name\": \"compare_weather\", \"arguments\": \"{\\\"city1\\\":\\\"London\\\",\\\"city2\\\":\\\"Tokyo\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 126,
      "completion": 20
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "Compare the weather between London and Tokyo"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "9f7c9085-4d25-496c-b4c8-72c9597af3e4",
    "parentRunId": "1c554ef9-051c-4157-bfb2-dc79743a2f6b",
    "timestamp": "2025-06-26T08:04:54.325Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Compare the weather between London and Tokyo\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_omes1y8gaRaHh7lq8jCBpujx\", \"type\": \"function\", \"function\": {\"name\": \"compare_weather\", \"arguments\": \"{\\\"city1\\\":\\\"London\\\",\\\"city2\\\":\\\"Tokyo\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2030.724
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 126,
      "completion": 20
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_omes1y8gaRaHh7lq8jCBpujx",
            "type": "function",
            "function": {
              "name": "compare_weather",
              "arguments": "{\"city1\":\"London\",\"city2\":\"Tokyo\"}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "d2d9846e-1fb4-4575-8e14-1ce3bb68104d",
    "parentRunId": "1c554ef9-051c-4157-bfb2-dc79743a2f6b",
    "timestamp": "2025-06-26T08:04:54.326Z",
    "metadata": {
      "toolName": "compare_weather",
      "toolCallId": "call_omes1y8gaRaHh7lq8jCBpujx",
      "tool_arguments": "{\"city1\":\"London\",\"city2\":\"Tokyo\"}",
      "logfire_msg": "running tool: compare_weather",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "city1": "London",
      "city2": "Tokyo"
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "d2d9846e-1fb4-4575-8e14-1ce3bb68104d",
    "parentRunId": "1c554ef9-051c-4157-bfb2-dc79743a2f6b",
    "timestamp": "2025-06-26T08:04:54.327Z",
    "metadata": {
      "toolName": "compare_weather",
      "toolCallId": "call_omes1y8gaRaHh7lq8jCBpujx",
      "tool_arguments": "{\"city1\":\"London\",\"city2\":\"Tokyo\"}",
      "logfire_msg": "running tool: compare_weather",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.619
    },
    "output": "Tool executed successfully"
  }
]
Using project key: 07ff18c9-f052-4260-9e89-ea93fe9ba8c5
âœ… Successfully forwarded to backend

ðŸ”­ Received traces: 1 ResourceSpans
Resource attributes: {
  "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
  "telemetry.sdk.language": "python",
  "telemetry.sdk.name": "opentelemetry",
  "telemetry.sdk.version": "1.34.1",
  "service.name": "lunary-weather-agent",
  "process.pid": 21067,
  "process.runtime.name": "cpython",
  "process.runtime.version": "3.13.5",
  "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
  "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
}
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events

ðŸ”§ Fixing parent-child relationships...
Before fix:
- llm 6b372e49-0ec0-4d52-a39a-d7e7b15c5efe parent: 4d2f1e3a-e46b-4b76-a0c0-0727a43d04c8
- llm 6b372e49-0ec0-4d52-a39a-d7e7b15c5efe parent: 4d2f1e3a-e46b-4b76-a0c0-0727a43d04c8
- agent 2f95736b-d4b4-44ab-86e8-3e06ef5b8238 parent: none
- agent 2f95736b-d4b4-44ab-86e8-3e06ef5b8238 parent: none
- llm 5c00370e-9bbf-4454-9962-380244693ada parent: e6634a7f-5a16-4c73-991e-8b5ed2a8d8a0
- llm 5c00370e-9bbf-4454-9962-380244693ada parent: e6634a7f-5a16-4c73-991e-8b5ed2a8d8a0
- tool 85bb6e00-335e-4f05-9127-b21973251480 parent: b30810cf-051f-4ef5-afe5-a4b9fc40323b
- tool 85bb6e00-335e-4f05-9127-b21973251480 parent: b30810cf-051f-4ef5-afe5-a4b9fc40323b
- llm 036bb606-c84a-4d9c-8ae3-b1dc92a2a48d parent: ae11da15-7b03-49e7-896d-a35750574a26
- llm 036bb606-c84a-4d9c-8ae3-b1dc92a2a48d parent: ae11da15-7b03-49e7-896d-a35750574a26
- agent 99a0586f-67de-4050-8f33-6394b39c059f parent: none
- agent 99a0586f-67de-4050-8f33-6394b39c059f parent: none
- llm abdb0ac5-ed0c-486f-9488-c889f0e411a8 parent: a05102d5-2111-4157-ab49-5789e528510b
- llm abdb0ac5-ed0c-486f-9488-c889f0e411a8 parent: a05102d5-2111-4157-ab49-5789e528510b
- tool 6f81472c-d468-4407-bb5c-41381d13d41f parent: 22482672-8ba9-46c8-bb58-d053e13d5afa
- tool 6f81472c-d468-4407-bb5c-41381d13d41f parent: 22482672-8ba9-46c8-bb58-d053e13d5afa
- tool 1ea96def-617c-4e44-b73d-1ed798e9cc67 parent: 90d8f777-5e25-4a79-a128-845b916a056f
- tool 1ea96def-617c-4e44-b73d-1ed798e9cc67 parent: 90d8f777-5e25-4a79-a128-845b916a056f
- llm 0bf789cd-801a-40df-978b-7cc566213608 parent: c72a394b-8042-4f1b-9201-cc6bb42f2fc3
- llm 0bf789cd-801a-40df-978b-7cc566213608 parent: c72a394b-8042-4f1b-9201-cc6bb42f2fc3
- agent a2a3b187-f3a4-4634-bdf4-51aaf4357b2f parent: none
- agent a2a3b187-f3a4-4634-bdf4-51aaf4357b2f parent: none

After fix:
- llm 6b372e49-0ec0-4d52-a39a-d7e7b15c5efe parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- llm 6b372e49-0ec0-4d52-a39a-d7e7b15c5efe parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- agent 2f95736b-d4b4-44ab-86e8-3e06ef5b8238 parent: none
- agent 2f95736b-d4b4-44ab-86e8-3e06ef5b8238 parent: none
- llm 5c00370e-9bbf-4454-9962-380244693ada parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- llm 5c00370e-9bbf-4454-9962-380244693ada parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- tool 85bb6e00-335e-4f05-9127-b21973251480 parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- tool 85bb6e00-335e-4f05-9127-b21973251480 parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- llm 036bb606-c84a-4d9c-8ae3-b1dc92a2a48d parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- llm 036bb606-c84a-4d9c-8ae3-b1dc92a2a48d parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- agent 99a0586f-67de-4050-8f33-6394b39c059f parent: none
- agent 99a0586f-67de-4050-8f33-6394b39c059f parent: none
- llm abdb0ac5-ed0c-486f-9488-c889f0e411a8 parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- llm abdb0ac5-ed0c-486f-9488-c889f0e411a8 parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- tool 6f81472c-d468-4407-bb5c-41381d13d41f parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- tool 6f81472c-d468-4407-bb5c-41381d13d41f parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- tool 1ea96def-617c-4e44-b73d-1ed798e9cc67 parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- tool 1ea96def-617c-4e44-b73d-1ed798e9cc67 parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- llm 0bf789cd-801a-40df-978b-7cc566213608 parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- llm 0bf789cd-801a-40df-978b-7cc566213608 parent: 2f95736b-d4b4-44ab-86e8-3e06ef5b8238
- agent a2a3b187-f3a4-4634-bdf4-51aaf4357b2f parent: none
- agent a2a3b187-f3a4-4634-bdf4-51aaf4357b2f parent: none

ðŸ“¥ Forwarding 22 events to backend
Events: [
  {
    "type": "llm",
    "event": "start",
    "runId": "6b372e49-0ec0-4d52-a39a-d7e7b15c5efe",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:54.327Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Compare the weather between London and Tokyo\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_omes1y8gaRaHh7lq8jCBpujx\", \"type\": \"function\", \"function\": {\"name\": \"compare_weather\", \"arguments\": \"{\\\"city1\\\":\\\"London\\\",\\\"city2\\\":\\\"Tokyo\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"comparison\": {\"London\": {\"temperature\": 59, \"condition\": \"Rainy\"}, \"Tokyo\": {\"temperature\": 68, \"condition\": \"Clear\"}, \"temperature_difference\": 9, \"warmer_city\": \"Tokyo\"}}, \"role\": \"tool\", \"id\": \"call_omes1y8gaRaHh7lq8jCBpujx\", \"name\": \"compare_weather\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"The current weather comparison between London and Tokyo is as follows:\\n\\n- **London**: \\n  - Temperature: 59\\u00b0F\\n  - Condition: Rainy\\n\\n- **Tokyo**: \\n  - Temperature: 68\\u00b0F\\n  - Condition: Clear\\n\\nTokyo is currently warmer than London by 9\\u00b0F.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 191,
      "completion": 65
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "Compare the weather between London and Tokyo"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "6b372e49-0ec0-4d52-a39a-d7e7b15c5efe",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:56.001Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Compare the weather between London and Tokyo\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_omes1y8gaRaHh7lq8jCBpujx\", \"type\": \"function\", \"function\": {\"name\": \"compare_weather\", \"arguments\": \"{\\\"city1\\\":\\\"London\\\",\\\"city2\\\":\\\"Tokyo\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"comparison\": {\"London\": {\"temperature\": 59, \"condition\": \"Rainy\"}, \"Tokyo\": {\"temperature\": 68, \"condition\": \"Clear\"}, \"temperature_difference\": 9, \"warmer_city\": \"Tokyo\"}}, \"role\": \"tool\", \"id\": \"call_omes1y8gaRaHh7lq8jCBpujx\", \"name\": \"compare_weather\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"The current weather comparison between London and Tokyo is as follows:\\n\\n- **London**: \\n  - Temperature: 59\\u00b0F\\n  - Condition: Rainy\\n\\n- **Tokyo**: \\n  - Temperature: 68\\u00b0F\\n  - Condition: Clear\\n\\nTokyo is currently warmer than London by 9\\u00b0F.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1673.477
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 191,
      "completion": 65
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "content": "The current weather comparison between London and Tokyo is as follows:\n\n- **London**: \n  - Temperature: 59Â°F\n  - Condition: Rainy\n\n- **Tokyo**: \n  - Temperature: 68Â°F\n  - Condition: Clear\n\nTokyo is currently warmer than London by 9Â°F."
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:52.293Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "The current weather comparison between London and Tokyo is as follows:\n\n- **London**: \n  - Temperature: 59Â°F\n  - Condition: Rainy\n\n- **Tokyo**: \n  - Temperature: 68Â°F\n  - Condition: Clear\n\nTokyo is currently warmer than London by 9Â°F.",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Compare the weather between London and Tokyo\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_omes1y8gaRaHh7lq8jCBpujx\", \"type\": \"function\", \"function\": {\"name\": \"compare_weather\", \"arguments\": \"{\\\"city1\\\":\\\"London\\\",\\\"city2\\\":\\\"Tokyo\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"comparison\": {\"London\": {\"temperature\": 59, \"condition\": \"Rainy\"}, \"Tokyo\": {\"temperature\": 68, \"condition\": \"Clear\"}, \"temperature_difference\": 9, \"warmer_city\": \"Tokyo\"}}, \"role\": \"tool\", \"id\": \"call_omes1y8gaRaHh7lq8jCBpujx\", \"name\": \"compare_weather\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"The current weather comparison between London and Tokyo is as follows:\\n\\n- **London**: \\n  - Temperature: 59\\u00b0F\\n  - Condition: Rainy\\n\\n- **Tokyo**: \\n  - Temperature: 68\\u00b0F\\n  - Condition: Clear\\n\\nTokyo is currently warmer than London by 9\\u00b0F.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 317,
      "completion": 85
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "Compare the weather between London and Tokyo"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:56.002Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "The current weather comparison between London and Tokyo is as follows:\n\n- **London**: \n  - Temperature: 59Â°F\n  - Condition: Rainy\n\n- **Tokyo**: \n  - Temperature: 68Â°F\n  - Condition: Clear\n\nTokyo is currently warmer than London by 9Â°F.",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Compare the weather between London and Tokyo\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_omes1y8gaRaHh7lq8jCBpujx\", \"type\": \"function\", \"function\": {\"name\": \"compare_weather\", \"arguments\": \"{\\\"city1\\\":\\\"London\\\",\\\"city2\\\":\\\"Tokyo\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"comparison\": {\"London\": {\"temperature\": 59, \"condition\": \"Rainy\"}, \"Tokyo\": {\"temperature\": 68, \"condition\": \"Clear\"}, \"temperature_difference\": 9, \"warmer_city\": \"Tokyo\"}}, \"role\": \"tool\", \"id\": \"call_omes1y8gaRaHh7lq8jCBpujx\", \"name\": \"compare_weather\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"The current weather comparison between London and Tokyo is as follows:\\n\\n- **London**: \\n  - Temperature: 59\\u00b0F\\n  - Condition: Rainy\\n\\n- **Tokyo**: \\n  - Temperature: 68\\u00b0F\\n  - Condition: Clear\\n\\nTokyo is currently warmer than London by 9\\u00b0F.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 3708.084
    },
    "tokensUsage": {
      "prompt": 317,
      "completion": 85
    },
    "output": "The current weather comparison between London and Tokyo is as follows:\n\n- **London**: \n  - Temperature: 59Â°F\n  - Condition: Rainy\n\n- **Tokyo**: \n  - Temperature: 68Â°F\n  - Condition: Clear\n\nTokyo is currently warmer than London by 9Â°F."
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "5c00370e-9bbf-4454-9962-380244693ada",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:56.003Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Give me a 5-day forecast for Paris\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zP5zEHt0XxJvYMBBRvcB0gRt\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\":\\\"Paris\\\",\\\"days\\\":5}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 128,
      "completion": 20
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "Give me a 5-day forecast for Paris"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "5c00370e-9bbf-4454-9962-380244693ada",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:56.857Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Give me a 5-day forecast for Paris\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zP5zEHt0XxJvYMBBRvcB0gRt\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\":\\\"Paris\\\",\\\"days\\\":5}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 854.091
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 128,
      "completion": 20
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_zP5zEHt0XxJvYMBBRvcB0gRt",
            "type": "function",
            "function": {
              "name": "get_weather_forecast",
              "arguments": "{\"city\":\"Paris\",\"days\":5}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "85bb6e00-335e-4f05-9127-b21973251480",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:56.858Z",
    "metadata": {
      "toolName": "get_weather_forecast",
      "toolCallId": "call_zP5zEHt0XxJvYMBBRvcB0gRt",
      "tool_arguments": "{\"city\":\"Paris\",\"days\":5}",
      "logfire_msg": "running tool: get_weather_forecast",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "city": "Paris",
      "days": 5
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "85bb6e00-335e-4f05-9127-b21973251480",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:56.858Z",
    "metadata": {
      "toolName": "get_weather_forecast",
      "toolCallId": "call_zP5zEHt0XxJvYMBBRvcB0gRt",
      "tool_arguments": "{\"city\":\"Paris\",\"days\":5}",
      "logfire_msg": "running tool: get_weather_forecast",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.595
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "036bb606-c84a-4d9c-8ae3-b1dc92a2a48d",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:56.859Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Give me a 5-day forecast for Paris\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zP5zEHt0XxJvYMBBRvcB0gRt\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\":\\\"Paris\\\",\\\"days\\\":5}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Paris\", \"forecast\": [{\"day\": 1, \"high\": 63, \"low\": 58, \"condition\": \"Cloudy\"}, {\"day\": 2, \"high\": 65, \"low\": 59, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 67, \"low\": 60, \"condition\": \"Partly Cloudy\"}, {\"day\": 4, \"high\": 69, \"low\": 61, \"condition\": \"Partly Cloudy\"}, {\"day\": 5, \"high\": 71, \"low\": 62, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_zP5zEHt0XxJvYMBBRvcB0gRt\", \"name\": \"get_weather_forecast\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"Here's the 5-day weather forecast for Paris:\\n\\n- **Day 1:** High of 63\\u00b0F, Low of 58\\u00b0F - Cloudy\\n- **Day 2:** High of 65\\u00b0F, Low of 59\\u00b0F - Partly Cloudy\\n- **Day 3:** High of 67\\u00b0F, Low of 60\\u00b0F - Partly Cloudy\\n- **Day 4:** High of 69\\u00b0F, Low of 61\\u00b0F - Partly Cloudy\\n- **Day 5:** High of 71\\u00b0F, Low of 62\\u00b0F - Partly Cloudy\\n\\nIt looks like the weather will be gradually getting warmer with some cloud cover throughout the week.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 265,
      "completion": 142
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "Give me a 5-day forecast for Paris"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "036bb606-c84a-4d9c-8ae3-b1dc92a2a48d",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:59.013Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Give me a 5-day forecast for Paris\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zP5zEHt0XxJvYMBBRvcB0gRt\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\":\\\"Paris\\\",\\\"days\\\":5}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Paris\", \"forecast\": [{\"day\": 1, \"high\": 63, \"low\": 58, \"condition\": \"Cloudy\"}, {\"day\": 2, \"high\": 65, \"low\": 59, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 67, \"low\": 60, \"condition\": \"Partly Cloudy\"}, {\"day\": 4, \"high\": 69, \"low\": 61, \"condition\": \"Partly Cloudy\"}, {\"day\": 5, \"high\": 71, \"low\": 62, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_zP5zEHt0XxJvYMBBRvcB0gRt\", \"name\": \"get_weather_forecast\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"Here's the 5-day weather forecast for Paris:\\n\\n- **Day 1:** High of 63\\u00b0F, Low of 58\\u00b0F - Cloudy\\n- **Day 2:** High of 65\\u00b0F, Low of 59\\u00b0F - Partly Cloudy\\n- **Day 3:** High of 67\\u00b0F, Low of 60\\u00b0F - Partly Cloudy\\n- **Day 4:** High of 69\\u00b0F, Low of 61\\u00b0F - Partly Cloudy\\n- **Day 5:** High of 71\\u00b0F, Low of 62\\u00b0F - Partly Cloudy\\n\\nIt looks like the weather will be gradually getting warmer with some cloud cover throughout the week.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2154.014
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 265,
      "completion": 142
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "content": "Here's the 5-day weather forecast for Paris:\n\n- **Day 1:** High of 63Â°F, Low of 58Â°F - Cloudy\n- **Day 2:** High of 65Â°F, Low of 59Â°F - Partly Cloudy\n- **Day 3:** High of 67Â°F, Low of 60Â°F - Partly Cloudy\n- **Day 4:** High of 69Â°F, Low of 61Â°F - Partly Cloudy\n- **Day 5:** High of 71Â°F, Low of 62Â°F - Partly Cloudy\n\nIt looks like the weather will be gradually getting warmer with some cloud cover throughout the week."
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "99a0586f-67de-4050-8f33-6394b39c059f",
    "timestamp": "2025-06-26T08:04:56.002Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "Here's the 5-day weather forecast for Paris:\n\n- **Day 1:** High of 63Â°F, Low of 58Â°F - Cloudy\n- **Day 2:** High of 65Â°F, Low of 59Â°F - Partly Cloudy\n- **Day 3:** High of 67Â°F, Low of 60Â°F - Partly Cloudy\n- **Day 4:** High of 69Â°F, Low of 61Â°F - Partly Cloudy\n- **Day 5:** High of 71Â°F, Low of 62Â°F - Partly Cloudy\n\nIt looks like the weather will be gradually getting warmer with some cloud cover throughout the week.",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Give me a 5-day forecast for Paris\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zP5zEHt0XxJvYMBBRvcB0gRt\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\":\\\"Paris\\\",\\\"days\\\":5}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Paris\", \"forecast\": [{\"day\": 1, \"high\": 63, \"low\": 58, \"condition\": \"Cloudy\"}, {\"day\": 2, \"high\": 65, \"low\": 59, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 67, \"low\": 60, \"condition\": \"Partly Cloudy\"}, {\"day\": 4, \"high\": 69, \"low\": 61, \"condition\": \"Partly Cloudy\"}, {\"day\": 5, \"high\": 71, \"low\": 62, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_zP5zEHt0XxJvYMBBRvcB0gRt\", \"name\": \"get_weather_forecast\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"Here's the 5-day weather forecast for Paris:\\n\\n- **Day 1:** High of 63\\u00b0F, Low of 58\\u00b0F - Cloudy\\n- **Day 2:** High of 65\\u00b0F, Low of 59\\u00b0F - Partly Cloudy\\n- **Day 3:** High of 67\\u00b0F, Low of 60\\u00b0F - Partly Cloudy\\n- **Day 4:** High of 69\\u00b0F, Low of 61\\u00b0F - Partly Cloudy\\n- **Day 5:** High of 71\\u00b0F, Low of 62\\u00b0F - Partly Cloudy\\n\\nIt looks like the weather will be gradually getting warmer with some cloud cover throughout the week.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 393,
      "completion": 162
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "Give me a 5-day forecast for Paris"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "99a0586f-67de-4050-8f33-6394b39c059f",
    "timestamp": "2025-06-26T08:04:59.014Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "Here's the 5-day weather forecast for Paris:\n\n- **Day 1:** High of 63Â°F, Low of 58Â°F - Cloudy\n- **Day 2:** High of 65Â°F, Low of 59Â°F - Partly Cloudy\n- **Day 3:** High of 67Â°F, Low of 60Â°F - Partly Cloudy\n- **Day 4:** High of 69Â°F, Low of 61Â°F - Partly Cloudy\n- **Day 5:** High of 71Â°F, Low of 62Â°F - Partly Cloudy\n\nIt looks like the weather will be gradually getting warmer with some cloud cover throughout the week.",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Give me a 5-day forecast for Paris\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zP5zEHt0XxJvYMBBRvcB0gRt\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\":\\\"Paris\\\",\\\"days\\\":5}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Paris\", \"forecast\": [{\"day\": 1, \"high\": 63, \"low\": 58, \"condition\": \"Cloudy\"}, {\"day\": 2, \"high\": 65, \"low\": 59, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 67, \"low\": 60, \"condition\": \"Partly Cloudy\"}, {\"day\": 4, \"high\": 69, \"low\": 61, \"condition\": \"Partly Cloudy\"}, {\"day\": 5, \"high\": 71, \"low\": 62, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_zP5zEHt0XxJvYMBBRvcB0gRt\", \"name\": \"get_weather_forecast\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"Here's the 5-day weather forecast for Paris:\\n\\n- **Day 1:** High of 63\\u00b0F, Low of 58\\u00b0F - Cloudy\\n- **Day 2:** High of 65\\u00b0F, Low of 59\\u00b0F - Partly Cloudy\\n- **Day 3:** High of 67\\u00b0F, Low of 60\\u00b0F - Partly Cloudy\\n- **Day 4:** High of 69\\u00b0F, Low of 61\\u00b0F - Partly Cloudy\\n- **Day 5:** High of 71\\u00b0F, Low of 62\\u00b0F - Partly Cloudy\\n\\nIt looks like the weather will be gradually getting warmer with some cloud cover throughout the week.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 3012.074
    },
    "tokensUsage": {
      "prompt": 393,
      "completion": 162
    },
    "output": "Here's the 5-day weather forecast for Paris:\n\n- **Day 1:** High of 63Â°F, Low of 58Â°F - Cloudy\n- **Day 2:** High of 65Â°F, Low of 59Â°F - Partly Cloudy\n- **Day 3:** High of 67Â°F, Low of 60Â°F - Partly Cloudy\n- **Day 4:** High of 69Â°F, Low of 61Â°F - Partly Cloudy\n- **Day 5:** High of 71Â°F, Low of 62Â°F - Partly Cloudy\n\nIt looks like the weather will be gradually getting warmer with some cloud cover throughout the week."
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "abdb0ac5-ed0c-486f-9488-c889f0e411a8",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:59.016Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the current weather in Sydney and give me a forecast for London?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_MBFa1MuffhLjCzdzf6CL2p2V\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\": \\\"Sydney\\\"}\"}}, {\"id\": \"call_FxdQZCoxoATJsjVdbypsI0aT\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\": \\\"London\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 133,
      "completion": 47
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the current weather in Sydney and give me a forecast for London?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "abdb0ac5-ed0c-486f-9488-c889f0e411a8",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:59.829Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the current weather in Sydney and give me a forecast for London?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_MBFa1MuffhLjCzdzf6CL2p2V\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\": \\\"Sydney\\\"}\"}}, {\"id\": \"call_FxdQZCoxoATJsjVdbypsI0aT\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\": \\\"London\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 813.697
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 133,
      "completion": 47
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_MBFa1MuffhLjCzdzf6CL2p2V",
            "type": "function",
            "function": {
              "name": "get_current_weather",
              "arguments": "{\"city\": \"Sydney\"}"
            }
          },
          {
            "id": "call_FxdQZCoxoATJsjVdbypsI0aT",
            "type": "function",
            "function": {
              "name": "get_weather_forecast",
              "arguments": "{\"city\": \"London\"}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "6f81472c-d468-4407-bb5c-41381d13d41f",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:59.830Z",
    "metadata": {
      "toolName": "get_weather_forecast",
      "toolCallId": "call_FxdQZCoxoATJsjVdbypsI0aT",
      "tool_arguments": "{\"city\": \"London\"}",
      "logfire_msg": "running tool: get_weather_forecast",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "city": "London"
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "6f81472c-d468-4407-bb5c-41381d13d41f",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:59.831Z",
    "metadata": {
      "toolName": "get_weather_forecast",
      "toolCallId": "call_FxdQZCoxoATJsjVdbypsI0aT",
      "tool_arguments": "{\"city\": \"London\"}",
      "logfire_msg": "running tool: get_weather_forecast",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1.034
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "1ea96def-617c-4e44-b73d-1ed798e9cc67",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:59.830Z",
    "metadata": {
      "toolName": "get_current_weather",
      "toolCallId": "call_MBFa1MuffhLjCzdzf6CL2p2V",
      "tool_arguments": "{\"city\": \"Sydney\"}",
      "logfire_msg": "running tool: get_current_weather",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "city": "Sydney"
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "1ea96def-617c-4e44-b73d-1ed798e9cc67",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:59.832Z",
    "metadata": {
      "toolName": "get_current_weather",
      "toolCallId": "call_MBFa1MuffhLjCzdzf6CL2p2V",
      "tool_arguments": "{\"city\": \"Sydney\"}",
      "logfire_msg": "running tool: get_current_weather",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1.304
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "0bf789cd-801a-40df-978b-7cc566213608",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:04:59.832Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the current weather in Sydney and give me a forecast for London?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_MBFa1MuffhLjCzdzf6CL2p2V\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\": \\\"Sydney\\\"}\"}}, {\"id\": \"call_FxdQZCoxoATJsjVdbypsI0aT\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\": \\\"London\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Sydney\", \"temperature\": 77, \"condition\": \"Sunny\", \"humidity\": 60, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_MBFa1MuffhLjCzdzf6CL2p2V\", \"name\": \"get_current_weather\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"content\": {\"city\": \"London\", \"forecast\": [{\"day\": 1, \"high\": 59, \"low\": 54, \"condition\": \"Rainy\"}, {\"day\": 2, \"high\": 61, \"low\": 55, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 63, \"low\": 56, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_FxdQZCoxoATJsjVdbypsI0aT\", \"name\": \"get_weather_forecast\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"The current weather in Sydney is sunny, with a temperature of 77\\u00b0F and a humidity of 60%.\\n\\nFor London, here is the weather forecast:\\n- **Day 1:** High of 59\\u00b0F, Low of 54\\u00b0F, Rainy\\n- **Day 2:** High of 61\\u00b0F, Low of 55\\u00b0F, Partly Cloudy\\n- **Day 3:** High of 63\\u00b0F, Low of 56\\u00b0F, Partly Cloudy\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 319,
      "completion": 98
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the current weather in Sydney and give me a forecast for London?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "0bf789cd-801a-40df-978b-7cc566213608",
    "parentRunId": "2f95736b-d4b4-44ab-86e8-3e06ef5b8238",
    "timestamp": "2025-06-26T08:05:01.796Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the current weather in Sydney and give me a forecast for London?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_MBFa1MuffhLjCzdzf6CL2p2V\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\": \\\"Sydney\\\"}\"}}, {\"id\": \"call_FxdQZCoxoATJsjVdbypsI0aT\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\": \\\"London\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Sydney\", \"temperature\": 77, \"condition\": \"Sunny\", \"humidity\": 60, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_MBFa1MuffhLjCzdzf6CL2p2V\", \"name\": \"get_current_weather\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"content\": {\"city\": \"London\", \"forecast\": [{\"day\": 1, \"high\": 59, \"low\": 54, \"condition\": \"Rainy\"}, {\"day\": 2, \"high\": 61, \"low\": 55, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 63, \"low\": 56, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_FxdQZCoxoATJsjVdbypsI0aT\", \"name\": \"get_weather_forecast\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"The current weather in Sydney is sunny, with a temperature of 77\\u00b0F and a humidity of 60%.\\n\\nFor London, here is the weather forecast:\\n- **Day 1:** High of 59\\u00b0F, Low of 54\\u00b0F, Rainy\\n- **Day 2:** High of 61\\u00b0F, Low of 55\\u00b0F, Partly Cloudy\\n- **Day 3:** High of 63\\u00b0F, Low of 56\\u00b0F, Partly Cloudy\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1964.092
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 319,
      "completion": 98
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "content": "The current weather in Sydney is sunny, with a temperature of 77Â°F and a humidity of 60%.\n\nFor London, here is the weather forecast:\n- **Day 1:** High of 59Â°F, Low of 54Â°F, Rainy\n- **Day 2:** High of 61Â°F, Low of 55Â°F, Partly Cloudy\n- **Day 3:** High of 63Â°F, Low of 56Â°F, Partly Cloudy"
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "a2a3b187-f3a4-4634-bdf4-51aaf4357b2f",
    "timestamp": "2025-06-26T08:04:59.015Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "The current weather in Sydney is sunny, with a temperature of 77Â°F and a humidity of 60%.\n\nFor London, here is the weather forecast:\n- **Day 1:** High of 59Â°F, Low of 54Â°F, Rainy\n- **Day 2:** High of 61Â°F, Low of 55Â°F, Partly Cloudy\n- **Day 3:** High of 63Â°F, Low of 56Â°F, Partly Cloudy",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the current weather in Sydney and give me a forecast for London?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_MBFa1MuffhLjCzdzf6CL2p2V\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\": \\\"Sydney\\\"}\"}}, {\"id\": \"call_FxdQZCoxoATJsjVdbypsI0aT\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\": \\\"London\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Sydney\", \"temperature\": 77, \"condition\": \"Sunny\", \"humidity\": 60, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_MBFa1MuffhLjCzdzf6CL2p2V\", \"name\": \"get_current_weather\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"content\": {\"city\": \"London\", \"forecast\": [{\"day\": 1, \"high\": 59, \"low\": 54, \"condition\": \"Rainy\"}, {\"day\": 2, \"high\": 61, \"low\": 55, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 63, \"low\": 56, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_FxdQZCoxoATJsjVdbypsI0aT\", \"name\": \"get_weather_forecast\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"The current weather in Sydney is sunny, with a temperature of 77\\u00b0F and a humidity of 60%.\\n\\nFor London, here is the weather forecast:\\n- **Day 1:** High of 59\\u00b0F, Low of 54\\u00b0F, Rainy\\n- **Day 2:** High of 61\\u00b0F, Low of 55\\u00b0F, Partly Cloudy\\n- **Day 3:** High of 63\\u00b0F, Low of 56\\u00b0F, Partly Cloudy\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 452,
      "completion": 145
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the current weather in Sydney and give me a forecast for London?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "a2a3b187-f3a4-4634-bdf4-51aaf4357b2f",
    "timestamp": "2025-06-26T08:05:01.798Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "The current weather in Sydney is sunny, with a temperature of 77Â°F and a humidity of 60%.\n\nFor London, here is the weather forecast:\n- **Day 1:** High of 59Â°F, Low of 54Â°F, Rainy\n- **Day 2:** High of 61Â°F, Low of 55Â°F, Partly Cloudy\n- **Day 3:** High of 63Â°F, Low of 56Â°F, Partly Cloudy",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the current weather in Sydney and give me a forecast for London?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_MBFa1MuffhLjCzdzf6CL2p2V\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\": \\\"Sydney\\\"}\"}}, {\"id\": \"call_FxdQZCoxoATJsjVdbypsI0aT\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\": \\\"London\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Sydney\", \"temperature\": 77, \"condition\": \"Sunny\", \"humidity\": 60, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_MBFa1MuffhLjCzdzf6CL2p2V\", \"name\": \"get_current_weather\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"content\": {\"city\": \"London\", \"forecast\": [{\"day\": 1, \"high\": 59, \"low\": 54, \"condition\": \"Rainy\"}, {\"day\": 2, \"high\": 61, \"low\": 55, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 63, \"low\": 56, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_FxdQZCoxoATJsjVdbypsI0aT\", \"name\": \"get_weather_forecast\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"The current weather in Sydney is sunny, with a temperature of 77\\u00b0F and a humidity of 60%.\\n\\nFor London, here is the weather forecast:\\n- **Day 1:** High of 59\\u00b0F, Low of 54\\u00b0F, Rainy\\n- **Day 2:** High of 61\\u00b0F, Low of 55\\u00b0F, Partly Cloudy\\n- **Day 3:** High of 63\\u00b0F, Low of 56\\u00b0F, Partly Cloudy\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2782.684
    },
    "tokensUsage": {
      "prompt": 452,
      "completion": 145
    },
    "output": "The current weather in Sydney is sunny, with a temperature of 77Â°F and a humidity of 60%.\n\nFor London, here is the weather forecast:\n- **Day 1:** High of 59Â°F, Low of 54Â°F, Rainy\n- **Day 2:** High of 61Â°F, Low of 55Â°F, Partly Cloudy\n- **Day 3:** High of 63Â°F, Low of 56Â°F, Partly Cloudy"
  }
]
Using project key: 07ff18c9-f052-4260-9e89-ea93fe9ba8c5
âœ… Successfully forwarded to backend

ðŸ”­ Received traces: 1 ResourceSpans
Resource attributes: {
  "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
  "telemetry.sdk.language": "python",
  "telemetry.sdk.name": "opentelemetry",
  "telemetry.sdk.version": "1.34.1",
  "service.name": "lunary-weather-agent",
  "process.pid": 21067,
  "process.runtime.name": "cpython",
  "process.runtime.version": "3.13.5",
  "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
  "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
}
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events

ðŸ”§ Fixing parent-child relationships...
Before fix:
- llm bcad359a-d4aa-45b8-8d6a-d0272ed49821 parent: d9f067e4-3f43-4ea6-9a2e-4090d7b88926
- llm bcad359a-d4aa-45b8-8d6a-d0272ed49821 parent: d9f067e4-3f43-4ea6-9a2e-4090d7b88926
- agent 1a2ab97c-ccd0-498e-92c9-1e20d31ca583 parent: none
- agent 1a2ab97c-ccd0-498e-92c9-1e20d31ca583 parent: none

After fix:
- llm bcad359a-d4aa-45b8-8d6a-d0272ed49821 parent: 1a2ab97c-ccd0-498e-92c9-1e20d31ca583
- llm bcad359a-d4aa-45b8-8d6a-d0272ed49821 parent: 1a2ab97c-ccd0-498e-92c9-1e20d31ca583
- agent 1a2ab97c-ccd0-498e-92c9-1e20d31ca583 parent: none
- agent 1a2ab97c-ccd0-498e-92c9-1e20d31ca583 parent: none

ðŸ“¥ Forwarding 4 events to backend
Events: [
  {
    "type": "llm",
    "event": "start",
    "runId": "bcad359a-d4aa-45b8-8d6a-d0272ed49821",
    "parentRunId": "1a2ab97c-ccd0-498e-92c9-1e20d31ca583",
    "timestamp": "2025-06-26T08:05:01.799Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather in Antarctica?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"Antarctica is a large continent with various research stations rather than cities. Could you specify which research station or area in Antarctica you are interested in, such as McMurdo Station, Amundsen-Scott South Pole Station, or another area?\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 125,
      "completion": 51
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the weather in Antarctica?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "bcad359a-d4aa-45b8-8d6a-d0272ed49821",
    "parentRunId": "1a2ab97c-ccd0-498e-92c9-1e20d31ca583",
    "timestamp": "2025-06-26T08:05:04.349Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather in Antarctica?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"Antarctica is a large continent with various research stations rather than cities. Could you specify which research station or area in Antarctica you are interested in, such as McMurdo Station, Amundsen-Scott South Pole Station, or another area?\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2549.917
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 125,
      "completion": 51
    },
    "output": [
      {
        "role": "assistant",
        "content": "Antarctica is a large continent with various research stations rather than cities. Could you specify which research station or area in Antarctica you are interested in, such as McMurdo Station, Amundsen-Scott South Pole Station, or another area?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "1a2ab97c-ccd0-498e-92c9-1e20d31ca583",
    "timestamp": "2025-06-26T08:05:01.798Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "Antarctica is a large continent with various research stations rather than cities. Could you specify which research station or area in Antarctica you are interested in, such as McMurdo Station, Amundsen-Scott South Pole Station, or another area?",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather in Antarctica?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"content\": \"Antarctica is a large continent with various research stations rather than cities. Could you specify which research station or area in Antarctica you are interested in, such as McMurdo Station, Amundsen-Scott South Pole Station, or another area?\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 125,
      "completion": 51
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the weather in Antarctica?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "1a2ab97c-ccd0-498e-92c9-1e20d31ca583",
    "timestamp": "2025-06-26T08:05:04.350Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "Antarctica is a large continent with various research stations rather than cities. Could you specify which research station or area in Antarctica you are interested in, such as McMurdo Station, Amundsen-Scott South Pole Station, or another area?",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather in Antarctica?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"content\": \"Antarctica is a large continent with various research stations rather than cities. Could you specify which research station or area in Antarctica you are interested in, such as McMurdo Station, Amundsen-Scott South Pole Station, or another area?\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "ea1e8c0c114c47b690d9b17bd28d3d2f",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-weather-agent",
      "process.pid": 21067,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2551.76
    },
    "tokensUsage": {
      "prompt": 125,
      "completion": 51
    },
    "output": "Antarctica is a large continent with various research stations rather than cities. Could you specify which research station or area in Antarctica you are interested in, such as McMurdo Station, Amundsen-Scott South Pole Station, or another area?"
  }
]
Using project key: 07ff18c9-f052-4260-9e89-ea93fe9ba8c5
âœ… Successfully forwarded to backend
ðŸ“Š metrics: 1 ResourceMetrics

ðŸ”­ Received traces: 1 ResourceSpans
Resource attributes: {
  "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
  "telemetry.sdk.language": "python",
  "telemetry.sdk.name": "opentelemetry",
  "telemetry.sdk.version": "1.34.1",
  "service.name": "unknown_service",
  "process.pid": 24002,
  "process.runtime.name": "cpython",
  "process.runtime.version": "3.13.5",
  "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
  "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
}
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events

ðŸ”§ Fixing parent-child relationships...
Before fix:
- llm 3c4b92ef-537d-4ccf-acdb-e5b4db11bfce parent: 77c9d5c4-d755-427a-beb0-903c32d891a8
- llm 3c4b92ef-537d-4ccf-acdb-e5b4db11bfce parent: 77c9d5c4-d755-427a-beb0-903c32d891a8
- tool 170b4a81-f37f-444b-9f6a-6f48606e7688 parent: e6be3f83-92ae-44a9-9ac7-2214c8372607
- tool 170b4a81-f37f-444b-9f6a-6f48606e7688 parent: e6be3f83-92ae-44a9-9ac7-2214c8372607
- llm ab416891-3dd0-417b-83fb-3c9bd138b27c parent: e32f0e15-a4d7-42f3-8d8a-6dd56d8ec592
- llm ab416891-3dd0-417b-83fb-3c9bd138b27c parent: e32f0e15-a4d7-42f3-8d8a-6dd56d8ec592
- agent deb010c1-eb52-4312-9491-585ac9312453 parent: none
- agent deb010c1-eb52-4312-9491-585ac9312453 parent: none
- llm f126fd55-d3ec-459f-95b7-df43f33912e1 parent: 39099c8f-b1fe-405c-b9d9-a897917f41f1
- llm f126fd55-d3ec-459f-95b7-df43f33912e1 parent: 39099c8f-b1fe-405c-b9d9-a897917f41f1
- tool 078d7c68-cfc3-4753-af3d-660a294e912d parent: 597ab3aa-602d-43a4-b2a6-7a4f56a0c696
- tool 078d7c68-cfc3-4753-af3d-660a294e912d parent: 597ab3aa-602d-43a4-b2a6-7a4f56a0c696

After fix:
- llm 3c4b92ef-537d-4ccf-acdb-e5b4db11bfce parent: deb010c1-eb52-4312-9491-585ac9312453
- llm 3c4b92ef-537d-4ccf-acdb-e5b4db11bfce parent: deb010c1-eb52-4312-9491-585ac9312453
- tool 170b4a81-f37f-444b-9f6a-6f48606e7688 parent: deb010c1-eb52-4312-9491-585ac9312453
- tool 170b4a81-f37f-444b-9f6a-6f48606e7688 parent: deb010c1-eb52-4312-9491-585ac9312453
- llm ab416891-3dd0-417b-83fb-3c9bd138b27c parent: deb010c1-eb52-4312-9491-585ac9312453
- llm ab416891-3dd0-417b-83fb-3c9bd138b27c parent: deb010c1-eb52-4312-9491-585ac9312453
- agent deb010c1-eb52-4312-9491-585ac9312453 parent: none
- agent deb010c1-eb52-4312-9491-585ac9312453 parent: none
- llm f126fd55-d3ec-459f-95b7-df43f33912e1 parent: deb010c1-eb52-4312-9491-585ac9312453
- llm f126fd55-d3ec-459f-95b7-df43f33912e1 parent: deb010c1-eb52-4312-9491-585ac9312453
- tool 078d7c68-cfc3-4753-af3d-660a294e912d parent: deb010c1-eb52-4312-9491-585ac9312453
- tool 078d7c68-cfc3-4753-af3d-660a294e912d parent: deb010c1-eb52-4312-9491-585ac9312453

ðŸ“¥ Forwarding 12 events to backend
Events: [
  {
    "type": "llm",
    "event": "start",
    "runId": "3c4b92ef-537d-4ccf-acdb-e5b4db11bfce",
    "parentRunId": "deb010c1-eb52-4312-9491-585ac9312453",
    "timestamp": "2025-06-26T08:28:24.309Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather like in New York?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_510CWBs486KBY5IzZLi5dQow\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\":\\\"New York\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 127,
      "completion": 16
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the weather like in New York?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "3c4b92ef-537d-4ccf-acdb-e5b4db11bfce",
    "parentRunId": "deb010c1-eb52-4312-9491-585ac9312453",
    "timestamp": "2025-06-26T08:28:25.367Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather like in New York?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_510CWBs486KBY5IzZLi5dQow\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\":\\\"New York\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1058.005
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 127,
      "completion": 16
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_510CWBs486KBY5IzZLi5dQow",
            "type": "function",
            "function": {
              "name": "get_current_weather",
              "arguments": "{\"city\":\"New York\"}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "170b4a81-f37f-444b-9f6a-6f48606e7688",
    "parentRunId": "deb010c1-eb52-4312-9491-585ac9312453",
    "timestamp": "2025-06-26T08:28:25.370Z",
    "metadata": {
      "toolName": "get_current_weather",
      "toolCallId": "call_510CWBs486KBY5IzZLi5dQow",
      "tool_arguments": "{\"city\":\"New York\"}",
      "logfire_msg": "running tool: get_current_weather",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "city": "New York"
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "170b4a81-f37f-444b-9f6a-6f48606e7688",
    "parentRunId": "deb010c1-eb52-4312-9491-585ac9312453",
    "timestamp": "2025-06-26T08:28:25.371Z",
    "metadata": {
      "toolName": "get_current_weather",
      "toolCallId": "call_510CWBs486KBY5IzZLi5dQow",
      "tool_arguments": "{\"city\":\"New York\"}",
      "logfire_msg": "running tool: get_current_weather",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1.378
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "ab416891-3dd0-417b-83fb-3c9bd138b27c",
    "parentRunId": "deb010c1-eb52-4312-9491-585ac9312453",
    "timestamp": "2025-06-26T08:28:25.372Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather like in New York?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_510CWBs486KBY5IzZLi5dQow\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\":\\\"New York\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"New York\", \"temperature\": 72, \"condition\": \"Partly Cloudy\", \"humidity\": 65, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_510CWBs486KBY5IzZLi5dQow\", \"name\": \"get_current_weather\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"The current weather in New York is partly cloudy with a temperature of 72\\u00b0F and a humidity level of 65%.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 178,
      "completion": 25
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the weather like in New York?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "ab416891-3dd0-417b-83fb-3c9bd138b27c",
    "parentRunId": "deb010c1-eb52-4312-9491-585ac9312453",
    "timestamp": "2025-06-26T08:28:26.334Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather like in New York?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_510CWBs486KBY5IzZLi5dQow\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\":\\\"New York\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"New York\", \"temperature\": 72, \"condition\": \"Partly Cloudy\", \"humidity\": 65, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_510CWBs486KBY5IzZLi5dQow\", \"name\": \"get_current_weather\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"The current weather in New York is partly cloudy with a temperature of 72\\u00b0F and a humidity level of 65%.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 961.103
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 178,
      "completion": 25
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "content": "The current weather in New York is partly cloudy with a temperature of 72Â°F and a humidity level of 65%."
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "deb010c1-eb52-4312-9491-585ac9312453",
    "timestamp": "2025-06-26T08:28:24.308Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "The current weather in New York is partly cloudy with a temperature of 72Â°F and a humidity level of 65%.",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather like in New York?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_510CWBs486KBY5IzZLi5dQow\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\":\\\"New York\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"New York\", \"temperature\": 72, \"condition\": \"Partly Cloudy\", \"humidity\": 65, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_510CWBs486KBY5IzZLi5dQow\", \"name\": \"get_current_weather\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"The current weather in New York is partly cloudy with a temperature of 72\\u00b0F and a humidity level of 65%.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 305,
      "completion": 41
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the weather like in New York?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "deb010c1-eb52-4312-9491-585ac9312453",
    "timestamp": "2025-06-26T08:28:26.334Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "The current weather in New York is partly cloudy with a temperature of 72Â°F and a humidity level of 65%.",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather like in New York?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_510CWBs486KBY5IzZLi5dQow\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\":\\\"New York\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"New York\", \"temperature\": 72, \"condition\": \"Partly Cloudy\", \"humidity\": 65, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_510CWBs486KBY5IzZLi5dQow\", \"name\": \"get_current_weather\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"The current weather in New York is partly cloudy with a temperature of 72\\u00b0F and a humidity level of 65%.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2026.585
    },
    "tokensUsage": {
      "prompt": 305,
      "completion": 41
    },
    "output": "The current weather in New York is partly cloudy with a temperature of 72Â°F and a humidity level of 65%."
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "f126fd55-d3ec-459f-95b7-df43f33912e1",
    "parentRunId": "deb010c1-eb52-4312-9491-585ac9312453",
    "timestamp": "2025-06-26T08:28:26.336Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Compare the weather between London and Tokyo\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_Wx9RLj3ynM7Z9sRj2m3vCwKi\", \"type\": \"function\", \"function\": {\"name\": \"compare_weather\", \"arguments\": \"{\\\"city1\\\":\\\"London\\\",\\\"city2\\\":\\\"Tokyo\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 126,
      "completion": 20
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "Compare the weather between London and Tokyo"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "f126fd55-d3ec-459f-95b7-df43f33912e1",
    "parentRunId": "deb010c1-eb52-4312-9491-585ac9312453",
    "timestamp": "2025-06-26T08:28:28.042Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Compare the weather between London and Tokyo\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_Wx9RLj3ynM7Z9sRj2m3vCwKi\", \"type\": \"function\", \"function\": {\"name\": \"compare_weather\", \"arguments\": \"{\\\"city1\\\":\\\"London\\\",\\\"city2\\\":\\\"Tokyo\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1705.402
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 126,
      "completion": 20
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_Wx9RLj3ynM7Z9sRj2m3vCwKi",
            "type": "function",
            "function": {
              "name": "compare_weather",
              "arguments": "{\"city1\":\"London\",\"city2\":\"Tokyo\"}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "078d7c68-cfc3-4753-af3d-660a294e912d",
    "parentRunId": "deb010c1-eb52-4312-9491-585ac9312453",
    "timestamp": "2025-06-26T08:28:28.043Z",
    "metadata": {
      "toolName": "compare_weather",
      "toolCallId": "call_Wx9RLj3ynM7Z9sRj2m3vCwKi",
      "tool_arguments": "{\"city1\":\"London\",\"city2\":\"Tokyo\"}",
      "logfire_msg": "running tool: compare_weather",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "city1": "London",
      "city2": "Tokyo"
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "078d7c68-cfc3-4753-af3d-660a294e912d",
    "parentRunId": "deb010c1-eb52-4312-9491-585ac9312453",
    "timestamp": "2025-06-26T08:28:28.043Z",
    "metadata": {
      "toolName": "compare_weather",
      "toolCallId": "call_Wx9RLj3ynM7Z9sRj2m3vCwKi",
      "tool_arguments": "{\"city1\":\"London\",\"city2\":\"Tokyo\"}",
      "logfire_msg": "running tool: compare_weather",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.66
    },
    "output": "Tool executed successfully"
  }
]
Using project key: 07ff18c9-f052-4260-9e89-ea93fe9ba8c5
âœ… Successfully forwarded to backend

ðŸ”­ Received traces: 1 ResourceSpans
Resource attributes: {
  "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
  "telemetry.sdk.language": "python",
  "telemetry.sdk.name": "opentelemetry",
  "telemetry.sdk.version": "1.34.1",
  "service.name": "unknown_service",
  "process.pid": 24002,
  "process.runtime.name": "cpython",
  "process.runtime.version": "3.13.5",
  "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
  "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
}
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events

ðŸ”§ Fixing parent-child relationships...
Before fix:
- llm 6d88314b-7467-4d4d-bbb7-9fa9ebbb4037 parent: 5b55efce-6f01-4768-aefa-9b9abda7fda7
- llm 6d88314b-7467-4d4d-bbb7-9fa9ebbb4037 parent: 5b55efce-6f01-4768-aefa-9b9abda7fda7
- agent 3d82984d-1b82-44e6-bb03-b65f57c26fcf parent: none
- agent 3d82984d-1b82-44e6-bb03-b65f57c26fcf parent: none
- llm dd7df1ee-93bf-45ec-9e3d-ae44eef55484 parent: 6eff301b-1c3f-44be-b458-9ed6d0510fb3
- llm dd7df1ee-93bf-45ec-9e3d-ae44eef55484 parent: 6eff301b-1c3f-44be-b458-9ed6d0510fb3
- tool 55c28618-b223-47d1-abaa-5d590b6a620d parent: ce11491d-d9ac-4b90-9769-9593d7c9203c
- tool 55c28618-b223-47d1-abaa-5d590b6a620d parent: ce11491d-d9ac-4b90-9769-9593d7c9203c
- llm c95df31f-7828-43c2-baa7-e832566d6fb0 parent: 0898498a-5207-413a-be71-2fa62db400c2
- llm c95df31f-7828-43c2-baa7-e832566d6fb0 parent: 0898498a-5207-413a-be71-2fa62db400c2
- agent bfeeebab-aeaa-49e0-9203-02ea3e4af3ec parent: none
- agent bfeeebab-aeaa-49e0-9203-02ea3e4af3ec parent: none

After fix:
- llm 6d88314b-7467-4d4d-bbb7-9fa9ebbb4037 parent: 3d82984d-1b82-44e6-bb03-b65f57c26fcf
- llm 6d88314b-7467-4d4d-bbb7-9fa9ebbb4037 parent: 3d82984d-1b82-44e6-bb03-b65f57c26fcf
- agent 3d82984d-1b82-44e6-bb03-b65f57c26fcf parent: none
- agent 3d82984d-1b82-44e6-bb03-b65f57c26fcf parent: none
- llm dd7df1ee-93bf-45ec-9e3d-ae44eef55484 parent: 3d82984d-1b82-44e6-bb03-b65f57c26fcf
- llm dd7df1ee-93bf-45ec-9e3d-ae44eef55484 parent: 3d82984d-1b82-44e6-bb03-b65f57c26fcf
- tool 55c28618-b223-47d1-abaa-5d590b6a620d parent: 3d82984d-1b82-44e6-bb03-b65f57c26fcf
- tool 55c28618-b223-47d1-abaa-5d590b6a620d parent: 3d82984d-1b82-44e6-bb03-b65f57c26fcf
- llm c95df31f-7828-43c2-baa7-e832566d6fb0 parent: 3d82984d-1b82-44e6-bb03-b65f57c26fcf
- llm c95df31f-7828-43c2-baa7-e832566d6fb0 parent: 3d82984d-1b82-44e6-bb03-b65f57c26fcf
- agent bfeeebab-aeaa-49e0-9203-02ea3e4af3ec parent: none
- agent bfeeebab-aeaa-49e0-9203-02ea3e4af3ec parent: none

ðŸ“¥ Forwarding 12 events to backend
Events: [
  {
    "type": "llm",
    "event": "start",
    "runId": "6d88314b-7467-4d4d-bbb7-9fa9ebbb4037",
    "parentRunId": "3d82984d-1b82-44e6-bb03-b65f57c26fcf",
    "timestamp": "2025-06-26T08:28:28.044Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Compare the weather between London and Tokyo\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_Wx9RLj3ynM7Z9sRj2m3vCwKi\", \"type\": \"function\", \"function\": {\"name\": \"compare_weather\", \"arguments\": \"{\\\"city1\\\":\\\"London\\\",\\\"city2\\\":\\\"Tokyo\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"comparison\": {\"London\": {\"temperature\": 59, \"condition\": \"Rainy\"}, \"Tokyo\": {\"temperature\": 68, \"condition\": \"Clear\"}, \"temperature_difference\": 9, \"warmer_city\": \"Tokyo\"}}, \"role\": \"tool\", \"id\": \"call_Wx9RLj3ynM7Z9sRj2m3vCwKi\", \"name\": \"compare_weather\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"Currently, the weather comparison between London and Tokyo is as follows:\\n\\n- **London**: The temperature is 59\\u00b0F and the weather condition is rainy.\\n- **Tokyo**: The temperature is 68\\u00b0F and the weather condition is clear.\\n\\nTokyo is warmer than London by 9\\u00b0F.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 191,
      "completion": 60
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "Compare the weather between London and Tokyo"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "6d88314b-7467-4d4d-bbb7-9fa9ebbb4037",
    "parentRunId": "3d82984d-1b82-44e6-bb03-b65f57c26fcf",
    "timestamp": "2025-06-26T08:28:31.067Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Compare the weather between London and Tokyo\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_Wx9RLj3ynM7Z9sRj2m3vCwKi\", \"type\": \"function\", \"function\": {\"name\": \"compare_weather\", \"arguments\": \"{\\\"city1\\\":\\\"London\\\",\\\"city2\\\":\\\"Tokyo\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"comparison\": {\"London\": {\"temperature\": 59, \"condition\": \"Rainy\"}, \"Tokyo\": {\"temperature\": 68, \"condition\": \"Clear\"}, \"temperature_difference\": 9, \"warmer_city\": \"Tokyo\"}}, \"role\": \"tool\", \"id\": \"call_Wx9RLj3ynM7Z9sRj2m3vCwKi\", \"name\": \"compare_weather\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"Currently, the weather comparison between London and Tokyo is as follows:\\n\\n- **London**: The temperature is 59\\u00b0F and the weather condition is rainy.\\n- **Tokyo**: The temperature is 68\\u00b0F and the weather condition is clear.\\n\\nTokyo is warmer than London by 9\\u00b0F.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 3022.694
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 191,
      "completion": 60
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "content": "Currently, the weather comparison between London and Tokyo is as follows:\n\n- **London**: The temperature is 59Â°F and the weather condition is rainy.\n- **Tokyo**: The temperature is 68Â°F and the weather condition is clear.\n\nTokyo is warmer than London by 9Â°F."
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "3d82984d-1b82-44e6-bb03-b65f57c26fcf",
    "timestamp": "2025-06-26T08:28:26.335Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "Currently, the weather comparison between London and Tokyo is as follows:\n\n- **London**: The temperature is 59Â°F and the weather condition is rainy.\n- **Tokyo**: The temperature is 68Â°F and the weather condition is clear.\n\nTokyo is warmer than London by 9Â°F.",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Compare the weather between London and Tokyo\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_Wx9RLj3ynM7Z9sRj2m3vCwKi\", \"type\": \"function\", \"function\": {\"name\": \"compare_weather\", \"arguments\": \"{\\\"city1\\\":\\\"London\\\",\\\"city2\\\":\\\"Tokyo\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"comparison\": {\"London\": {\"temperature\": 59, \"condition\": \"Rainy\"}, \"Tokyo\": {\"temperature\": 68, \"condition\": \"Clear\"}, \"temperature_difference\": 9, \"warmer_city\": \"Tokyo\"}}, \"role\": \"tool\", \"id\": \"call_Wx9RLj3ynM7Z9sRj2m3vCwKi\", \"name\": \"compare_weather\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"Currently, the weather comparison between London and Tokyo is as follows:\\n\\n- **London**: The temperature is 59\\u00b0F and the weather condition is rainy.\\n- **Tokyo**: The temperature is 68\\u00b0F and the weather condition is clear.\\n\\nTokyo is warmer than London by 9\\u00b0F.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 317,
      "completion": 80
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "Compare the weather between London and Tokyo"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "3d82984d-1b82-44e6-bb03-b65f57c26fcf",
    "timestamp": "2025-06-26T08:28:31.068Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "Currently, the weather comparison between London and Tokyo is as follows:\n\n- **London**: The temperature is 59Â°F and the weather condition is rainy.\n- **Tokyo**: The temperature is 68Â°F and the weather condition is clear.\n\nTokyo is warmer than London by 9Â°F.",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Compare the weather between London and Tokyo\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_Wx9RLj3ynM7Z9sRj2m3vCwKi\", \"type\": \"function\", \"function\": {\"name\": \"compare_weather\", \"arguments\": \"{\\\"city1\\\":\\\"London\\\",\\\"city2\\\":\\\"Tokyo\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"comparison\": {\"London\": {\"temperature\": 59, \"condition\": \"Rainy\"}, \"Tokyo\": {\"temperature\": 68, \"condition\": \"Clear\"}, \"temperature_difference\": 9, \"warmer_city\": \"Tokyo\"}}, \"role\": \"tool\", \"id\": \"call_Wx9RLj3ynM7Z9sRj2m3vCwKi\", \"name\": \"compare_weather\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"Currently, the weather comparison between London and Tokyo is as follows:\\n\\n- **London**: The temperature is 59\\u00b0F and the weather condition is rainy.\\n- **Tokyo**: The temperature is 68\\u00b0F and the weather condition is clear.\\n\\nTokyo is warmer than London by 9\\u00b0F.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 4732.435
    },
    "tokensUsage": {
      "prompt": 317,
      "completion": 80
    },
    "output": "Currently, the weather comparison between London and Tokyo is as follows:\n\n- **London**: The temperature is 59Â°F and the weather condition is rainy.\n- **Tokyo**: The temperature is 68Â°F and the weather condition is clear.\n\nTokyo is warmer than London by 9Â°F."
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "dd7df1ee-93bf-45ec-9e3d-ae44eef55484",
    "parentRunId": "3d82984d-1b82-44e6-bb03-b65f57c26fcf",
    "timestamp": "2025-06-26T08:28:31.070Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Give me a 5-day forecast for Paris\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_7Bi4pLmKcHuZdG9ypNvEwcOS\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\":\\\"Paris\\\",\\\"days\\\":5}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 128,
      "completion": 20
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "Give me a 5-day forecast for Paris"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "dd7df1ee-93bf-45ec-9e3d-ae44eef55484",
    "parentRunId": "3d82984d-1b82-44e6-bb03-b65f57c26fcf",
    "timestamp": "2025-06-26T08:28:31.714Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Give me a 5-day forecast for Paris\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_7Bi4pLmKcHuZdG9ypNvEwcOS\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\":\\\"Paris\\\",\\\"days\\\":5}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 644.766
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 128,
      "completion": 20
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_7Bi4pLmKcHuZdG9ypNvEwcOS",
            "type": "function",
            "function": {
              "name": "get_weather_forecast",
              "arguments": "{\"city\":\"Paris\",\"days\":5}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "55c28618-b223-47d1-abaa-5d590b6a620d",
    "parentRunId": "3d82984d-1b82-44e6-bb03-b65f57c26fcf",
    "timestamp": "2025-06-26T08:28:31.716Z",
    "metadata": {
      "toolName": "get_weather_forecast",
      "toolCallId": "call_7Bi4pLmKcHuZdG9ypNvEwcOS",
      "tool_arguments": "{\"city\":\"Paris\",\"days\":5}",
      "logfire_msg": "running tool: get_weather_forecast",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "city": "Paris",
      "days": 5
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "55c28618-b223-47d1-abaa-5d590b6a620d",
    "parentRunId": "3d82984d-1b82-44e6-bb03-b65f57c26fcf",
    "timestamp": "2025-06-26T08:28:31.717Z",
    "metadata": {
      "toolName": "get_weather_forecast",
      "toolCallId": "call_7Bi4pLmKcHuZdG9ypNvEwcOS",
      "tool_arguments": "{\"city\":\"Paris\",\"days\":5}",
      "logfire_msg": "running tool: get_weather_forecast",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.619
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "c95df31f-7828-43c2-baa7-e832566d6fb0",
    "parentRunId": "3d82984d-1b82-44e6-bb03-b65f57c26fcf",
    "timestamp": "2025-06-26T08:28:31.718Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Give me a 5-day forecast for Paris\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_7Bi4pLmKcHuZdG9ypNvEwcOS\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\":\\\"Paris\\\",\\\"days\\\":5}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Paris\", \"forecast\": [{\"day\": 1, \"high\": 63, \"low\": 58, \"condition\": \"Cloudy\"}, {\"day\": 2, \"high\": 65, \"low\": 59, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 67, \"low\": 60, \"condition\": \"Partly Cloudy\"}, {\"day\": 4, \"high\": 69, \"low\": 61, \"condition\": \"Partly Cloudy\"}, {\"day\": 5, \"high\": 71, \"low\": 62, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_7Bi4pLmKcHuZdG9ypNvEwcOS\", \"name\": \"get_weather_forecast\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"Here is the 5-day weather forecast for Paris:\\n\\n- **Day 1**: Cloudy, High of 63\\u00b0F, Low of 58\\u00b0F\\n- **Day 2**: Partly Cloudy, High of 65\\u00b0F, Low of 59\\u00b0F\\n- **Day 3**: Partly Cloudy, High of 67\\u00b0F, Low of 60\\u00b0F\\n- **Day 4**: Partly Cloudy, High of 69\\u00b0F, Low of 61\\u00b0F\\n- **Day 5**: Partly Cloudy, High of 71\\u00b0F, Low of 62\\u00b0F\\n\\nLet me know if you need more detailed information!\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 265,
      "completion": 140
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "Give me a 5-day forecast for Paris"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "c95df31f-7828-43c2-baa7-e832566d6fb0",
    "parentRunId": "3d82984d-1b82-44e6-bb03-b65f57c26fcf",
    "timestamp": "2025-06-26T08:28:35.097Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Give me a 5-day forecast for Paris\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_7Bi4pLmKcHuZdG9ypNvEwcOS\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\":\\\"Paris\\\",\\\"days\\\":5}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Paris\", \"forecast\": [{\"day\": 1, \"high\": 63, \"low\": 58, \"condition\": \"Cloudy\"}, {\"day\": 2, \"high\": 65, \"low\": 59, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 67, \"low\": 60, \"condition\": \"Partly Cloudy\"}, {\"day\": 4, \"high\": 69, \"low\": 61, \"condition\": \"Partly Cloudy\"}, {\"day\": 5, \"high\": 71, \"low\": 62, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_7Bi4pLmKcHuZdG9ypNvEwcOS\", \"name\": \"get_weather_forecast\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"Here is the 5-day weather forecast for Paris:\\n\\n- **Day 1**: Cloudy, High of 63\\u00b0F, Low of 58\\u00b0F\\n- **Day 2**: Partly Cloudy, High of 65\\u00b0F, Low of 59\\u00b0F\\n- **Day 3**: Partly Cloudy, High of 67\\u00b0F, Low of 60\\u00b0F\\n- **Day 4**: Partly Cloudy, High of 69\\u00b0F, Low of 61\\u00b0F\\n- **Day 5**: Partly Cloudy, High of 71\\u00b0F, Low of 62\\u00b0F\\n\\nLet me know if you need more detailed information!\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 3379.614
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 265,
      "completion": 140
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "content": "Here is the 5-day weather forecast for Paris:\n\n- **Day 1**: Cloudy, High of 63Â°F, Low of 58Â°F\n- **Day 2**: Partly Cloudy, High of 65Â°F, Low of 59Â°F\n- **Day 3**: Partly Cloudy, High of 67Â°F, Low of 60Â°F\n- **Day 4**: Partly Cloudy, High of 69Â°F, Low of 61Â°F\n- **Day 5**: Partly Cloudy, High of 71Â°F, Low of 62Â°F\n\nLet me know if you need more detailed information!"
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "bfeeebab-aeaa-49e0-9203-02ea3e4af3ec",
    "timestamp": "2025-06-26T08:28:31.068Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "Here is the 5-day weather forecast for Paris:\n\n- **Day 1**: Cloudy, High of 63Â°F, Low of 58Â°F\n- **Day 2**: Partly Cloudy, High of 65Â°F, Low of 59Â°F\n- **Day 3**: Partly Cloudy, High of 67Â°F, Low of 60Â°F\n- **Day 4**: Partly Cloudy, High of 69Â°F, Low of 61Â°F\n- **Day 5**: Partly Cloudy, High of 71Â°F, Low of 62Â°F\n\nLet me know if you need more detailed information!",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Give me a 5-day forecast for Paris\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_7Bi4pLmKcHuZdG9ypNvEwcOS\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\":\\\"Paris\\\",\\\"days\\\":5}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Paris\", \"forecast\": [{\"day\": 1, \"high\": 63, \"low\": 58, \"condition\": \"Cloudy\"}, {\"day\": 2, \"high\": 65, \"low\": 59, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 67, \"low\": 60, \"condition\": \"Partly Cloudy\"}, {\"day\": 4, \"high\": 69, \"low\": 61, \"condition\": \"Partly Cloudy\"}, {\"day\": 5, \"high\": 71, \"low\": 62, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_7Bi4pLmKcHuZdG9ypNvEwcOS\", \"name\": \"get_weather_forecast\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"Here is the 5-day weather forecast for Paris:\\n\\n- **Day 1**: Cloudy, High of 63\\u00b0F, Low of 58\\u00b0F\\n- **Day 2**: Partly Cloudy, High of 65\\u00b0F, Low of 59\\u00b0F\\n- **Day 3**: Partly Cloudy, High of 67\\u00b0F, Low of 60\\u00b0F\\n- **Day 4**: Partly Cloudy, High of 69\\u00b0F, Low of 61\\u00b0F\\n- **Day 5**: Partly Cloudy, High of 71\\u00b0F, Low of 62\\u00b0F\\n\\nLet me know if you need more detailed information!\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 393,
      "completion": 160
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "Give me a 5-day forecast for Paris"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "bfeeebab-aeaa-49e0-9203-02ea3e4af3ec",
    "timestamp": "2025-06-26T08:28:35.098Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "Here is the 5-day weather forecast for Paris:\n\n- **Day 1**: Cloudy, High of 63Â°F, Low of 58Â°F\n- **Day 2**: Partly Cloudy, High of 65Â°F, Low of 59Â°F\n- **Day 3**: Partly Cloudy, High of 67Â°F, Low of 60Â°F\n- **Day 4**: Partly Cloudy, High of 69Â°F, Low of 61Â°F\n- **Day 5**: Partly Cloudy, High of 71Â°F, Low of 62Â°F\n\nLet me know if you need more detailed information!",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Give me a 5-day forecast for Paris\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_7Bi4pLmKcHuZdG9ypNvEwcOS\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\":\\\"Paris\\\",\\\"days\\\":5}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Paris\", \"forecast\": [{\"day\": 1, \"high\": 63, \"low\": 58, \"condition\": \"Cloudy\"}, {\"day\": 2, \"high\": 65, \"low\": 59, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 67, \"low\": 60, \"condition\": \"Partly Cloudy\"}, {\"day\": 4, \"high\": 69, \"low\": 61, \"condition\": \"Partly Cloudy\"}, {\"day\": 5, \"high\": 71, \"low\": 62, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_7Bi4pLmKcHuZdG9ypNvEwcOS\", \"name\": \"get_weather_forecast\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"Here is the 5-day weather forecast for Paris:\\n\\n- **Day 1**: Cloudy, High of 63\\u00b0F, Low of 58\\u00b0F\\n- **Day 2**: Partly Cloudy, High of 65\\u00b0F, Low of 59\\u00b0F\\n- **Day 3**: Partly Cloudy, High of 67\\u00b0F, Low of 60\\u00b0F\\n- **Day 4**: Partly Cloudy, High of 69\\u00b0F, Low of 61\\u00b0F\\n- **Day 5**: Partly Cloudy, High of 71\\u00b0F, Low of 62\\u00b0F\\n\\nLet me know if you need more detailed information!\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 4029.607
    },
    "tokensUsage": {
      "prompt": 393,
      "completion": 160
    },
    "output": "Here is the 5-day weather forecast for Paris:\n\n- **Day 1**: Cloudy, High of 63Â°F, Low of 58Â°F\n- **Day 2**: Partly Cloudy, High of 65Â°F, Low of 59Â°F\n- **Day 3**: Partly Cloudy, High of 67Â°F, Low of 60Â°F\n- **Day 4**: Partly Cloudy, High of 69Â°F, Low of 61Â°F\n- **Day 5**: Partly Cloudy, High of 71Â°F, Low of 62Â°F\n\nLet me know if you need more detailed information!"
  }
]
Using project key: 07ff18c9-f052-4260-9e89-ea93fe9ba8c5
âœ… Successfully forwarded to backend

ðŸ”­ Received traces: 1 ResourceSpans
Resource attributes: {
  "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
  "telemetry.sdk.language": "python",
  "telemetry.sdk.name": "opentelemetry",
  "telemetry.sdk.version": "1.34.1",
  "service.name": "unknown_service",
  "process.pid": 24002,
  "process.runtime.name": "cpython",
  "process.runtime.version": "3.13.5",
  "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
  "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
}
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events

ðŸ”§ Fixing parent-child relationships...
Before fix:
- llm b93af702-9b92-41da-b070-15cba3119179 parent: 491ebe6c-dd6d-467f-966c-652f3927305c
- llm b93af702-9b92-41da-b070-15cba3119179 parent: 491ebe6c-dd6d-467f-966c-652f3927305c
- tool 08a1e9ac-98cb-42e2-a6da-9dbe3235f297 parent: f09a4afa-b12d-4b2d-b325-eae878a4d1cd
- tool 08a1e9ac-98cb-42e2-a6da-9dbe3235f297 parent: f09a4afa-b12d-4b2d-b325-eae878a4d1cd
- tool fb6b98e7-aec5-449f-8d60-d4199fe17edf parent: cb9ca1f9-a615-4fcf-84ce-d9fd6d53d43d
- tool fb6b98e7-aec5-449f-8d60-d4199fe17edf parent: cb9ca1f9-a615-4fcf-84ce-d9fd6d53d43d
- llm 6d55c20d-f812-43c5-8587-9432eaf3077a parent: 03725d5e-ef83-4be2-b422-58ee6c2b991f
- llm 6d55c20d-f812-43c5-8587-9432eaf3077a parent: 03725d5e-ef83-4be2-b422-58ee6c2b991f
- agent f6c7b3f5-d930-4db6-80b6-70fff3ae87c4 parent: none
- agent f6c7b3f5-d930-4db6-80b6-70fff3ae87c4 parent: none
- llm 8c703ad9-aeaf-4bff-b5fe-58360ef566c8 parent: 4f28456d-f200-444b-90af-b17ca825d4de
- llm 8c703ad9-aeaf-4bff-b5fe-58360ef566c8 parent: 4f28456d-f200-444b-90af-b17ca825d4de
- agent e7a4efb4-6d11-4b5e-ac29-0cd3d9cd573e parent: none
- agent e7a4efb4-6d11-4b5e-ac29-0cd3d9cd573e parent: none

After fix:
- llm b93af702-9b92-41da-b070-15cba3119179 parent: f6c7b3f5-d930-4db6-80b6-70fff3ae87c4
- llm b93af702-9b92-41da-b070-15cba3119179 parent: f6c7b3f5-d930-4db6-80b6-70fff3ae87c4
- tool 08a1e9ac-98cb-42e2-a6da-9dbe3235f297 parent: f6c7b3f5-d930-4db6-80b6-70fff3ae87c4
- tool 08a1e9ac-98cb-42e2-a6da-9dbe3235f297 parent: f6c7b3f5-d930-4db6-80b6-70fff3ae87c4
- tool fb6b98e7-aec5-449f-8d60-d4199fe17edf parent: f6c7b3f5-d930-4db6-80b6-70fff3ae87c4
- tool fb6b98e7-aec5-449f-8d60-d4199fe17edf parent: f6c7b3f5-d930-4db6-80b6-70fff3ae87c4
- llm 6d55c20d-f812-43c5-8587-9432eaf3077a parent: f6c7b3f5-d930-4db6-80b6-70fff3ae87c4
- llm 6d55c20d-f812-43c5-8587-9432eaf3077a parent: f6c7b3f5-d930-4db6-80b6-70fff3ae87c4
- agent f6c7b3f5-d930-4db6-80b6-70fff3ae87c4 parent: none
- agent f6c7b3f5-d930-4db6-80b6-70fff3ae87c4 parent: none
- llm 8c703ad9-aeaf-4bff-b5fe-58360ef566c8 parent: f6c7b3f5-d930-4db6-80b6-70fff3ae87c4
- llm 8c703ad9-aeaf-4bff-b5fe-58360ef566c8 parent: f6c7b3f5-d930-4db6-80b6-70fff3ae87c4
- agent e7a4efb4-6d11-4b5e-ac29-0cd3d9cd573e parent: none
- agent e7a4efb4-6d11-4b5e-ac29-0cd3d9cd573e parent: none

ðŸ“¥ Forwarding 14 events to backend
Events: [
  {
    "type": "llm",
    "event": "start",
    "runId": "b93af702-9b92-41da-b070-15cba3119179",
    "parentRunId": "f6c7b3f5-d930-4db6-80b6-70fff3ae87c4",
    "timestamp": "2025-06-26T08:28:35.099Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the current weather in Sydney and give me a forecast for London?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_76ZmKKNaaDZffNqvO6ekkjDG\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\": \\\"Sydney\\\"}\"}}, {\"id\": \"call_Yb6ABzcS6HVAqUs6edOBplPn\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\": \\\"London\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 133,
      "completion": 47
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the current weather in Sydney and give me a forecast for London?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "b93af702-9b92-41da-b070-15cba3119179",
    "parentRunId": "f6c7b3f5-d930-4db6-80b6-70fff3ae87c4",
    "timestamp": "2025-06-26T08:28:36.440Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the current weather in Sydney and give me a forecast for London?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_76ZmKKNaaDZffNqvO6ekkjDG\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\": \\\"Sydney\\\"}\"}}, {\"id\": \"call_Yb6ABzcS6HVAqUs6edOBplPn\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\": \\\"London\\\"}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1341.143
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 133,
      "completion": 47
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_76ZmKKNaaDZffNqvO6ekkjDG",
            "type": "function",
            "function": {
              "name": "get_current_weather",
              "arguments": "{\"city\": \"Sydney\"}"
            }
          },
          {
            "id": "call_Yb6ABzcS6HVAqUs6edOBplPn",
            "type": "function",
            "function": {
              "name": "get_weather_forecast",
              "arguments": "{\"city\": \"London\"}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "08a1e9ac-98cb-42e2-a6da-9dbe3235f297",
    "parentRunId": "f6c7b3f5-d930-4db6-80b6-70fff3ae87c4",
    "timestamp": "2025-06-26T08:28:36.441Z",
    "metadata": {
      "toolName": "get_current_weather",
      "toolCallId": "call_76ZmKKNaaDZffNqvO6ekkjDG",
      "tool_arguments": "{\"city\": \"Sydney\"}",
      "logfire_msg": "running tool: get_current_weather",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "city": "Sydney"
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "08a1e9ac-98cb-42e2-a6da-9dbe3235f297",
    "parentRunId": "f6c7b3f5-d930-4db6-80b6-70fff3ae87c4",
    "timestamp": "2025-06-26T08:28:36.442Z",
    "metadata": {
      "toolName": "get_current_weather",
      "toolCallId": "call_76ZmKKNaaDZffNqvO6ekkjDG",
      "tool_arguments": "{\"city\": \"Sydney\"}",
      "logfire_msg": "running tool: get_current_weather",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.832
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "fb6b98e7-aec5-449f-8d60-d4199fe17edf",
    "parentRunId": "f6c7b3f5-d930-4db6-80b6-70fff3ae87c4",
    "timestamp": "2025-06-26T08:28:36.441Z",
    "metadata": {
      "toolName": "get_weather_forecast",
      "toolCallId": "call_Yb6ABzcS6HVAqUs6edOBplPn",
      "tool_arguments": "{\"city\": \"London\"}",
      "logfire_msg": "running tool: get_weather_forecast",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "city": "London"
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "fb6b98e7-aec5-449f-8d60-d4199fe17edf",
    "parentRunId": "f6c7b3f5-d930-4db6-80b6-70fff3ae87c4",
    "timestamp": "2025-06-26T08:28:36.442Z",
    "metadata": {
      "toolName": "get_weather_forecast",
      "toolCallId": "call_Yb6ABzcS6HVAqUs6edOBplPn",
      "tool_arguments": "{\"city\": \"London\"}",
      "logfire_msg": "running tool: get_weather_forecast",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.7
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "6d55c20d-f812-43c5-8587-9432eaf3077a",
    "parentRunId": "f6c7b3f5-d930-4db6-80b6-70fff3ae87c4",
    "timestamp": "2025-06-26T08:28:36.443Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the current weather in Sydney and give me a forecast for London?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_76ZmKKNaaDZffNqvO6ekkjDG\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\": \\\"Sydney\\\"}\"}}, {\"id\": \"call_Yb6ABzcS6HVAqUs6edOBplPn\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\": \\\"London\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Sydney\", \"temperature\": 77, \"condition\": \"Sunny\", \"humidity\": 60, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_76ZmKKNaaDZffNqvO6ekkjDG\", \"name\": \"get_current_weather\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"content\": {\"city\": \"London\", \"forecast\": [{\"day\": 1, \"high\": 59, \"low\": 54, \"condition\": \"Rainy\"}, {\"day\": 2, \"high\": 61, \"low\": 55, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 63, \"low\": 56, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_Yb6ABzcS6HVAqUs6edOBplPn\", \"name\": \"get_weather_forecast\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"The current weather in Sydney is sunny with a temperature of 77\\u00b0F and 60% humidity.\\n\\nFor London, the weather forecast is as follows:\\n- Day 1: High of 59\\u00b0F, low of 54\\u00b0F, and rainy.\\n- Day 2: High of 61\\u00b0F, low of 55\\u00b0F, and partly cloudy.\\n- Day 3: High of 63\\u00b0F, low of 56\\u00b0F, and partly cloudy.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 319,
      "completion": 93
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the current weather in Sydney and give me a forecast for London?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "6d55c20d-f812-43c5-8587-9432eaf3077a",
    "parentRunId": "f6c7b3f5-d930-4db6-80b6-70fff3ae87c4",
    "timestamp": "2025-06-26T08:28:38.465Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the current weather in Sydney and give me a forecast for London?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_76ZmKKNaaDZffNqvO6ekkjDG\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\": \\\"Sydney\\\"}\"}}, {\"id\": \"call_Yb6ABzcS6HVAqUs6edOBplPn\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\": \\\"London\\\"}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Sydney\", \"temperature\": 77, \"condition\": \"Sunny\", \"humidity\": 60, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_76ZmKKNaaDZffNqvO6ekkjDG\", \"name\": \"get_current_weather\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"content\": {\"city\": \"London\", \"forecast\": [{\"day\": 1, \"high\": 59, \"low\": 54, \"condition\": \"Rainy\"}, {\"day\": 2, \"high\": 61, \"low\": 55, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 63, \"low\": 56, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_Yb6ABzcS6HVAqUs6edOBplPn\", \"name\": \"get_weather_forecast\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"The current weather in Sydney is sunny with a temperature of 77\\u00b0F and 60% humidity.\\n\\nFor London, the weather forecast is as follows:\\n- Day 1: High of 59\\u00b0F, low of 54\\u00b0F, and rainy.\\n- Day 2: High of 61\\u00b0F, low of 55\\u00b0F, and partly cloudy.\\n- Day 3: High of 63\\u00b0F, low of 56\\u00b0F, and partly cloudy.\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2022.13
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 319,
      "completion": 93
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "content": "The current weather in Sydney is sunny with a temperature of 77Â°F and 60% humidity.\n\nFor London, the weather forecast is as follows:\n- Day 1: High of 59Â°F, low of 54Â°F, and rainy.\n- Day 2: High of 61Â°F, low of 55Â°F, and partly cloudy.\n- Day 3: High of 63Â°F, low of 56Â°F, and partly cloudy."
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "f6c7b3f5-d930-4db6-80b6-70fff3ae87c4",
    "timestamp": "2025-06-26T08:28:35.099Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "The current weather in Sydney is sunny with a temperature of 77Â°F and 60% humidity.\n\nFor London, the weather forecast is as follows:\n- Day 1: High of 59Â°F, low of 54Â°F, and rainy.\n- Day 2: High of 61Â°F, low of 55Â°F, and partly cloudy.\n- Day 3: High of 63Â°F, low of 56Â°F, and partly cloudy.",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the current weather in Sydney and give me a forecast for London?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_76ZmKKNaaDZffNqvO6ekkjDG\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\": \\\"Sydney\\\"}\"}}, {\"id\": \"call_Yb6ABzcS6HVAqUs6edOBplPn\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\": \\\"London\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Sydney\", \"temperature\": 77, \"condition\": \"Sunny\", \"humidity\": 60, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_76ZmKKNaaDZffNqvO6ekkjDG\", \"name\": \"get_current_weather\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"content\": {\"city\": \"London\", \"forecast\": [{\"day\": 1, \"high\": 59, \"low\": 54, \"condition\": \"Rainy\"}, {\"day\": 2, \"high\": 61, \"low\": 55, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 63, \"low\": 56, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_Yb6ABzcS6HVAqUs6edOBplPn\", \"name\": \"get_weather_forecast\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"The current weather in Sydney is sunny with a temperature of 77\\u00b0F and 60% humidity.\\n\\nFor London, the weather forecast is as follows:\\n- Day 1: High of 59\\u00b0F, low of 54\\u00b0F, and rainy.\\n- Day 2: High of 61\\u00b0F, low of 55\\u00b0F, and partly cloudy.\\n- Day 3: High of 63\\u00b0F, low of 56\\u00b0F, and partly cloudy.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 452,
      "completion": 140
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the current weather in Sydney and give me a forecast for London?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "f6c7b3f5-d930-4db6-80b6-70fff3ae87c4",
    "timestamp": "2025-06-26T08:28:38.466Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "The current weather in Sydney is sunny with a temperature of 77Â°F and 60% humidity.\n\nFor London, the weather forecast is as follows:\n- Day 1: High of 59Â°F, low of 54Â°F, and rainy.\n- Day 2: High of 61Â°F, low of 55Â°F, and partly cloudy.\n- Day 3: High of 63Â°F, low of 56Â°F, and partly cloudy.",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the current weather in Sydney and give me a forecast for London?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_76ZmKKNaaDZffNqvO6ekkjDG\", \"type\": \"function\", \"function\": {\"name\": \"get_current_weather\", \"arguments\": \"{\\\"city\\\": \\\"Sydney\\\"}\"}}, {\"id\": \"call_Yb6ABzcS6HVAqUs6edOBplPn\", \"type\": \"function\", \"function\": {\"name\": \"get_weather_forecast\", \"arguments\": \"{\\\"city\\\": \\\"London\\\"}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": {\"city\": \"Sydney\", \"temperature\": 77, \"condition\": \"Sunny\", \"humidity\": 60, \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_76ZmKKNaaDZffNqvO6ekkjDG\", \"name\": \"get_current_weather\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"content\": {\"city\": \"London\", \"forecast\": [{\"day\": 1, \"high\": 59, \"low\": 54, \"condition\": \"Rainy\"}, {\"day\": 2, \"high\": 61, \"low\": 55, \"condition\": \"Partly Cloudy\"}, {\"day\": 3, \"high\": 63, \"low\": 56, \"condition\": \"Partly Cloudy\"}], \"unit\": \"fahrenheit\"}, \"role\": \"tool\", \"id\": \"call_Yb6ABzcS6HVAqUs6edOBplPn\", \"name\": \"get_weather_forecast\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"content\": \"The current weather in Sydney is sunny with a temperature of 77\\u00b0F and 60% humidity.\\n\\nFor London, the weather forecast is as follows:\\n- Day 1: High of 59\\u00b0F, low of 54\\u00b0F, and rainy.\\n- Day 2: High of 61\\u00b0F, low of 55\\u00b0F, and partly cloudy.\\n- Day 3: High of 63\\u00b0F, low of 56\\u00b0F, and partly cloudy.\", \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 3367.581
    },
    "tokensUsage": {
      "prompt": 452,
      "completion": 140
    },
    "output": "The current weather in Sydney is sunny with a temperature of 77Â°F and 60% humidity.\n\nFor London, the weather forecast is as follows:\n- Day 1: High of 59Â°F, low of 54Â°F, and rainy.\n- Day 2: High of 61Â°F, low of 55Â°F, and partly cloudy.\n- Day 3: High of 63Â°F, low of 56Â°F, and partly cloudy."
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "8c703ad9-aeaf-4bff-b5fe-58360ef566c8",
    "parentRunId": "f6c7b3f5-d930-4db6-80b6-70fff3ae87c4",
    "timestamp": "2025-06-26T08:28:38.468Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather in Antarctica?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"Antarctica doesn't have specific cities, but weather conditions can vary significantly across this vast continent. Would you like information for a specific research station or area in Antarctica? Common stations include McMurdo, Amundsen-Scott South Pole Station, and Palmer Station. Please let me know if you want information for a particular location!\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 125,
      "completion": 67
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the weather in Antarctica?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "8c703ad9-aeaf-4bff-b5fe-58360ef566c8",
    "parentRunId": "f6c7b3f5-d930-4db6-80b6-70fff3ae87c4",
    "timestamp": "2025-06-26T08:28:39.837Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"get_current_weather\", \"description\": \"Get the current weather for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}, {\"name\": \"get_weather_forecast\", \"description\": \"Get weather forecast for a given city\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city\": {\"type\": \"string\"}, \"days\": {\"type\": \"integer\"}}, \"required\": [\"city\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}, {\"name\": \"compare_weather\", \"description\": \"Compare weather between two cities\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"city1\": {\"type\": \"string\"}, \"city2\": {\"type\": \"string\"}}, \"required\": [\"city1\", \"city2\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"text\", \"output_object\": null, \"output_tools\": [], \"allow_text_output\": true}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather in Antarctica?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"content\": \"Antarctica doesn't have specific cities, but weather conditions can vary significantly across this vast continent. Would you like information for a specific research station or area in Antarctica? Common stations include McMurdo, Amundsen-Scott South Pole Station, and Palmer Station. Please let me know if you want information for a particular location!\"}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1368.46
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 125,
      "completion": 67
    },
    "output": [
      {
        "role": "assistant",
        "content": "Antarctica doesn't have specific cities, but weather conditions can vary significantly across this vast continent. Would you like information for a specific research station or area in Antarctica? Common stations include McMurdo, Amundsen-Scott South Pole Station, and Palmer Station. Please let me know if you want information for a particular location!"
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "e7a4efb4-6d11-4b5e-ac29-0cd3d9cd573e",
    "timestamp": "2025-06-26T08:28:38.467Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "Antarctica doesn't have specific cities, but weather conditions can vary significantly across this vast continent. Would you like information for a specific research station or area in Antarctica? Common stations include McMurdo, Amundsen-Scott South Pole Station, and Palmer Station. Please let me know if you want information for a particular location!",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather in Antarctica?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"content\": \"Antarctica doesn't have specific cities, but weather conditions can vary significantly across this vast continent. Would you like information for a specific research station or area in Antarctica? Common stations include McMurdo, Amundsen-Scott South Pole Station, and Palmer Station. Please let me know if you want information for a particular location!\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 125,
      "completion": 67
    },
    "input": [
      {
        "role": "system",
        "content": "You are a helpful weather assistant. Use the tools to get weather information for the user."
      },
      {
        "role": "user",
        "content": "What's the weather in Antarctica?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "e7a4efb4-6d11-4b5e-ac29-0cd3d9cd573e",
    "timestamp": "2025-06-26T08:28:39.838Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "weather_agent",
      "logfire_msg": "weather_agent run",
      "logfire_span_type": "span",
      "final_result": "Antarctica doesn't have specific cities, but weather conditions can vary significantly across this vast continent. Would you like information for a specific research station or area in Antarctica? Common stations include McMurdo, Amundsen-Scott South Pole Station, and Palmer Station. Please let me know if you want information for a particular location!",
      "all_messages_events": "[{\"content\": \"You are a helpful weather assistant. Use the tools to get weather information for the user.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What's the weather in Antarctica?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"content\": \"Antarctica doesn't have specific cities, but weather conditions can vary significantly across this vast continent. Would you like information for a specific research station or area in Antarctica? Common stations include McMurdo, Amundsen-Scott South Pole Station, and Palmer Station. Please let me know if you want information for a particular location!\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "2d77cfe12ca041d190c7a3e674d0292b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "unknown_service",
      "process.pid": 24002,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1370.404
    },
    "tokensUsage": {
      "prompt": 125,
      "completion": 67
    },
    "output": "Antarctica doesn't have specific cities, but weather conditions can vary significantly across this vast continent. Would you like information for a specific research station or area in Antarctica? Common stations include McMurdo, Amundsen-Scott South Pole Station, and Palmer Station. Please let me know if you want information for a particular location!"
  }
]
Using project key: 07ff18c9-f052-4260-9e89-ea93fe9ba8c5
âœ… Successfully forwarded to backend
ðŸ“Š metrics: 1 ResourceMetrics

ðŸ”­ Received traces: 1 ResourceSpans
Resource attributes: {
  "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
  "telemetry.sdk.language": "python",
  "telemetry.sdk.name": "opentelemetry",
  "telemetry.sdk.version": "1.34.1",
  "service.name": "lunary-bank-support",
  "process.pid": 24555,
  "process.runtime.name": "cpython",
  "process.runtime.version": "3.13.5",
  "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
  "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
}
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events

ðŸ”§ Fixing parent-child relationships...
Before fix:
- llm 4f3ee9bc-3e74-49f6-b991-3ec7ad9e5a94 parent: d396093f-ce41-49f8-8c11-063dba1a70af
- llm 4f3ee9bc-3e74-49f6-b991-3ec7ad9e5a94 parent: d396093f-ce41-49f8-8c11-063dba1a70af
- tool 50a49804-a067-436b-b58e-a32fef080e63 parent: bc070477-354d-43a6-a249-2661e752cd84
- tool 50a49804-a067-436b-b58e-a32fef080e63 parent: bc070477-354d-43a6-a249-2661e752cd84
- llm 55a9f84e-4f97-4880-847e-27129f40ab3b parent: f159028c-a883-4c27-8b93-7613fb33385c
- llm 55a9f84e-4f97-4880-847e-27129f40ab3b parent: f159028c-a883-4c27-8b93-7613fb33385c
- agent e3ae210c-14b3-4e60-9cc5-946b3cca5167 parent: none
- agent e3ae210c-14b3-4e60-9cc5-946b3cca5167 parent: none
- llm 593e529e-e3e8-467d-81c9-4ea31aa84e77 parent: baff49ae-0c70-4126-a14c-3d3987c567dc
- llm 593e529e-e3e8-467d-81c9-4ea31aa84e77 parent: baff49ae-0c70-4126-a14c-3d3987c567dc
- tool 8dd70325-fc30-4b9a-bd70-4d3725b7d12a parent: 8961f45c-b627-4548-bc76-9659340febca
- tool 8dd70325-fc30-4b9a-bd70-4d3725b7d12a parent: 8961f45c-b627-4548-bc76-9659340febca

After fix:
- llm 4f3ee9bc-3e74-49f6-b991-3ec7ad9e5a94 parent: e3ae210c-14b3-4e60-9cc5-946b3cca5167
- llm 4f3ee9bc-3e74-49f6-b991-3ec7ad9e5a94 parent: e3ae210c-14b3-4e60-9cc5-946b3cca5167
- tool 50a49804-a067-436b-b58e-a32fef080e63 parent: e3ae210c-14b3-4e60-9cc5-946b3cca5167
- tool 50a49804-a067-436b-b58e-a32fef080e63 parent: e3ae210c-14b3-4e60-9cc5-946b3cca5167
- llm 55a9f84e-4f97-4880-847e-27129f40ab3b parent: e3ae210c-14b3-4e60-9cc5-946b3cca5167
- llm 55a9f84e-4f97-4880-847e-27129f40ab3b parent: e3ae210c-14b3-4e60-9cc5-946b3cca5167
- agent e3ae210c-14b3-4e60-9cc5-946b3cca5167 parent: none
- agent e3ae210c-14b3-4e60-9cc5-946b3cca5167 parent: none
- llm 593e529e-e3e8-467d-81c9-4ea31aa84e77 parent: e3ae210c-14b3-4e60-9cc5-946b3cca5167
- llm 593e529e-e3e8-467d-81c9-4ea31aa84e77 parent: e3ae210c-14b3-4e60-9cc5-946b3cca5167
- tool 8dd70325-fc30-4b9a-bd70-4d3725b7d12a parent: e3ae210c-14b3-4e60-9cc5-946b3cca5167
- tool 8dd70325-fc30-4b9a-bd70-4d3725b7d12a parent: e3ae210c-14b3-4e60-9cc5-946b3cca5167

ðŸ“¥ Forwarding 12 events to backend
Events: [
  {
    "type": "llm",
    "event": "start",
    "runId": "4f3ee9bc-3e74-49f6-b991-3ec7ad9e5a94",
    "parentRunId": "e3ae210c-14b3-4e60-9cc5-946b3cca5167",
    "timestamp": "2025-06-26T08:32:37.984Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_uPzCvQJ6XG5f9Ol5FyBAAcY7\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 153,
      "completion": 15
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'John'"
      },
      {
        "role": "user",
        "content": "What is my balance?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "4f3ee9bc-3e74-49f6-b991-3ec7ad9e5a94",
    "parentRunId": "e3ae210c-14b3-4e60-9cc5-946b3cca5167",
    "timestamp": "2025-06-26T08:32:39.146Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_uPzCvQJ6XG5f9Ol5FyBAAcY7\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1161.668
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 153,
      "completion": 15
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_uPzCvQJ6XG5f9Ol5FyBAAcY7",
            "type": "function",
            "function": {
              "name": "customer_balance",
              "arguments": "{\"include_pending\":true}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "50a49804-a067-436b-b58e-a32fef080e63",
    "parentRunId": "e3ae210c-14b3-4e60-9cc5-946b3cca5167",
    "timestamp": "2025-06-26T08:32:39.147Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_uPzCvQJ6XG5f9Ol5FyBAAcY7",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "include_pending": true
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "50a49804-a067-436b-b58e-a32fef080e63",
    "parentRunId": "e3ae210c-14b3-4e60-9cc5-946b3cca5167",
    "timestamp": "2025-06-26T08:32:39.147Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_uPzCvQJ6XG5f9Ol5FyBAAcY7",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.215
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "55a9f84e-4f97-4880-847e-27129f40ab3b",
    "parentRunId": "e3ae210c-14b3-4e60-9cc5-946b3cca5167",
    "timestamp": "2025-06-26T08:32:39.148Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_uPzCvQJ6XG5f9Ol5FyBAAcY7\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_uPzCvQJ6XG5f9Ol5FyBAAcY7\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_fXHkCF51jGDFQeF6TFNxxnGJ\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\\\",\\\"block_card\\\":false,\\\"risk\\\":0}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 180,
      "completion": 55
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'John'"
      },
      {
        "role": "user",
        "content": "What is my balance?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "55a9f84e-4f97-4880-847e-27129f40ab3b",
    "parentRunId": "e3ae210c-14b3-4e60-9cc5-946b3cca5167",
    "timestamp": "2025-06-26T08:32:40.858Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_uPzCvQJ6XG5f9Ol5FyBAAcY7\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_uPzCvQJ6XG5f9Ol5FyBAAcY7\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_fXHkCF51jGDFQeF6TFNxxnGJ\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\\\",\\\"block_card\\\":false,\\\"risk\\\":0}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1709.796
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 180,
      "completion": 55
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_fXHkCF51jGDFQeF6TFNxxnGJ",
            "type": "function",
            "function": {
              "name": "final_result",
              "arguments": "{\"support_advice\":\"Your current account balance, including pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\",\"block_card\":false,\"risk\":0}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "e3ae210c-14b3-4e60-9cc5-946b3cca5167",
    "timestamp": "2025-06-26T08:32:37.983Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"Your current account balance, including pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\", \"block_card\": false, \"risk\": 0}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_uPzCvQJ6XG5f9Ol5FyBAAcY7\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_uPzCvQJ6XG5f9Ol5FyBAAcY7\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_fXHkCF51jGDFQeF6TFNxxnGJ\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\\\",\\\"block_card\\\":false,\\\"risk\\\":0}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_fXHkCF51jGDFQeF6TFNxxnGJ\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 333,
      "completion": 70
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'John'"
      },
      {
        "role": "user",
        "content": "What is my balance?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "e3ae210c-14b3-4e60-9cc5-946b3cca5167",
    "timestamp": "2025-06-26T08:32:40.858Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"Your current account balance, including pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\", \"block_card\": false, \"risk\": 0}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_uPzCvQJ6XG5f9Ol5FyBAAcY7\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_uPzCvQJ6XG5f9Ol5FyBAAcY7\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_fXHkCF51jGDFQeF6TFNxxnGJ\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\\\",\\\"block_card\\\":false,\\\"risk\\\":0}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_fXHkCF51jGDFQeF6TFNxxnGJ\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2875.857
    },
    "tokensUsage": {
      "prompt": 333,
      "completion": 70
    },
    "output": "{\"support_advice\": \"Your current account balance, including pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\", \"block_card\": false, \"risk\": 0}"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "593e529e-e3e8-467d-81c9-4ea31aa84e77",
    "parentRunId": "e3ae210c-14b3-4e60-9cc5-946b3cca5167",
    "timestamp": "2025-06-26T08:32:40.861Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"I just lost my card!\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_iGsWue0c62iPNIURBwbzOTtO\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 154,
      "completion": 15
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'John'"
      },
      {
        "role": "user",
        "content": "I just lost my card!"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "593e529e-e3e8-467d-81c9-4ea31aa84e77",
    "parentRunId": "e3ae210c-14b3-4e60-9cc5-946b3cca5167",
    "timestamp": "2025-06-26T08:32:41.667Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"I just lost my card!\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_iGsWue0c62iPNIURBwbzOTtO\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 806.281
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 154,
      "completion": 15
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_iGsWue0c62iPNIURBwbzOTtO",
            "type": "function",
            "function": {
              "name": "customer_balance",
              "arguments": "{\"include_pending\":true}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "8dd70325-fc30-4b9a-bd70-4d3725b7d12a",
    "parentRunId": "e3ae210c-14b3-4e60-9cc5-946b3cca5167",
    "timestamp": "2025-06-26T08:32:41.668Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_iGsWue0c62iPNIURBwbzOTtO",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "include_pending": true
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "8dd70325-fc30-4b9a-bd70-4d3725b7d12a",
    "parentRunId": "e3ae210c-14b3-4e60-9cc5-946b3cca5167",
    "timestamp": "2025-06-26T08:32:41.668Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_iGsWue0c62iPNIURBwbzOTtO",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.116
    },
    "output": "Tool executed successfully"
  }
]
Using project key: 07ff18c9-f052-4260-9e89-ea93fe9ba8c5
âœ… Successfully forwarded to backend

ðŸ”­ Received traces: 1 ResourceSpans
Resource attributes: {
  "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
  "telemetry.sdk.language": "python",
  "telemetry.sdk.name": "opentelemetry",
  "telemetry.sdk.version": "1.34.1",
  "service.name": "lunary-bank-support",
  "process.pid": 24555,
  "process.runtime.name": "cpython",
  "process.runtime.version": "3.13.5",
  "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
  "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
}
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events

ðŸ”§ Fixing parent-child relationships...
Before fix:
- llm 2e568f4b-66ef-4ae5-8efd-2a60badfaf6d parent: d068ea4d-a4f3-457f-a3c9-224eb91687bb
- llm 2e568f4b-66ef-4ae5-8efd-2a60badfaf6d parent: d068ea4d-a4f3-457f-a3c9-224eb91687bb
- agent 95152469-103c-4310-b008-56e5afdd270d parent: none
- agent 95152469-103c-4310-b008-56e5afdd270d parent: none
- llm fe88ee0e-3673-4053-9b6d-661f941bdb54 parent: 8cbd12f5-ebaa-4d5e-9df5-fe7908da6467
- llm fe88ee0e-3673-4053-9b6d-661f941bdb54 parent: 8cbd12f5-ebaa-4d5e-9df5-fe7908da6467
- tool 494c9da4-e365-4750-bae2-ea351ccffc53 parent: 80b9af74-5902-4144-bbfb-5d5d5410dd1a
- tool 494c9da4-e365-4750-bae2-ea351ccffc53 parent: 80b9af74-5902-4144-bbfb-5d5d5410dd1a
- llm a1670f3d-f5ec-4af9-9bf2-98699ec18e8a parent: a1eca1e8-6ce2-4d77-93ab-bd3a539913bb
- llm a1670f3d-f5ec-4af9-9bf2-98699ec18e8a parent: a1eca1e8-6ce2-4d77-93ab-bd3a539913bb
- agent a8412b9d-81a3-45a0-8cf3-0c25b80ffa3c parent: none
- agent a8412b9d-81a3-45a0-8cf3-0c25b80ffa3c parent: none
- llm 230b608f-d3e0-40c2-aad6-a97805939aac parent: 8b53601c-31a0-4a2d-8544-47ed98c7a797
- llm 230b608f-d3e0-40c2-aad6-a97805939aac parent: 8b53601c-31a0-4a2d-8544-47ed98c7a797
- tool 75de26e2-259e-4006-a255-050ff8a3f4f5 parent: ba194858-62bd-46eb-ab28-1a724ac41f22
- tool 75de26e2-259e-4006-a255-050ff8a3f4f5 parent: ba194858-62bd-46eb-ab28-1a724ac41f22
- llm 5382c291-f496-4b28-86e5-04f421e7abba parent: 0e44920f-1199-4636-9a06-8b1aa6993613
- llm 5382c291-f496-4b28-86e5-04f421e7abba parent: 0e44920f-1199-4636-9a06-8b1aa6993613
- agent 173c4127-97db-4d32-9ccf-aa77679bccbb parent: none
- agent 173c4127-97db-4d32-9ccf-aa77679bccbb parent: none

After fix:
- llm 2e568f4b-66ef-4ae5-8efd-2a60badfaf6d parent: 95152469-103c-4310-b008-56e5afdd270d
- llm 2e568f4b-66ef-4ae5-8efd-2a60badfaf6d parent: 95152469-103c-4310-b008-56e5afdd270d
- agent 95152469-103c-4310-b008-56e5afdd270d parent: none
- agent 95152469-103c-4310-b008-56e5afdd270d parent: none
- llm fe88ee0e-3673-4053-9b6d-661f941bdb54 parent: 95152469-103c-4310-b008-56e5afdd270d
- llm fe88ee0e-3673-4053-9b6d-661f941bdb54 parent: 95152469-103c-4310-b008-56e5afdd270d
- tool 494c9da4-e365-4750-bae2-ea351ccffc53 parent: 95152469-103c-4310-b008-56e5afdd270d
- tool 494c9da4-e365-4750-bae2-ea351ccffc53 parent: 95152469-103c-4310-b008-56e5afdd270d
- llm a1670f3d-f5ec-4af9-9bf2-98699ec18e8a parent: 95152469-103c-4310-b008-56e5afdd270d
- llm a1670f3d-f5ec-4af9-9bf2-98699ec18e8a parent: 95152469-103c-4310-b008-56e5afdd270d
- agent a8412b9d-81a3-45a0-8cf3-0c25b80ffa3c parent: none
- agent a8412b9d-81a3-45a0-8cf3-0c25b80ffa3c parent: none
- llm 230b608f-d3e0-40c2-aad6-a97805939aac parent: 95152469-103c-4310-b008-56e5afdd270d
- llm 230b608f-d3e0-40c2-aad6-a97805939aac parent: 95152469-103c-4310-b008-56e5afdd270d
- tool 75de26e2-259e-4006-a255-050ff8a3f4f5 parent: 95152469-103c-4310-b008-56e5afdd270d
- tool 75de26e2-259e-4006-a255-050ff8a3f4f5 parent: 95152469-103c-4310-b008-56e5afdd270d
- llm 5382c291-f496-4b28-86e5-04f421e7abba parent: 95152469-103c-4310-b008-56e5afdd270d
- llm 5382c291-f496-4b28-86e5-04f421e7abba parent: 95152469-103c-4310-b008-56e5afdd270d
- agent 173c4127-97db-4d32-9ccf-aa77679bccbb parent: none
- agent 173c4127-97db-4d32-9ccf-aa77679bccbb parent: none

ðŸ“¥ Forwarding 20 events to backend
Events: [
  {
    "type": "llm",
    "event": "start",
    "runId": "2e568f4b-66ef-4ae5-8efd-2a60badfaf6d",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:41.668Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"I just lost my card!\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_iGsWue0c62iPNIURBwbzOTtO\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_iGsWue0c62iPNIURBwbzOTtO\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_8ZFKFeRGibYRxSnKAG4tLLpL\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\": \\\"[Scrubbed due to 'auth']\\\", \\\"block_card\\\": true, \\\"risk\\\": 8}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "logfire_scrubbed": "[{\"path\": [\"attributes\", \"events\", 5, \"message\", \"tool_calls\", 0, \"function\", \"arguments\", \"support_advice\"], \"matched_substring\": \"auth\"}]",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 181,
      "completion": 73
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'John'"
      },
      {
        "role": "user",
        "content": "I just lost my card!"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "2e568f4b-66ef-4ae5-8efd-2a60badfaf6d",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:43.683Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"I just lost my card!\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_iGsWue0c62iPNIURBwbzOTtO\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_iGsWue0c62iPNIURBwbzOTtO\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_8ZFKFeRGibYRxSnKAG4tLLpL\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\": \\\"[Scrubbed due to 'auth']\\\", \\\"block_card\\\": true, \\\"risk\\\": 8}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "logfire_scrubbed": "[{\"path\": [\"attributes\", \"events\", 5, \"message\", \"tool_calls\", 0, \"function\", \"arguments\", \"support_advice\"], \"matched_substring\": \"auth\"}]",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2014.931
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 181,
      "completion": 73
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_8ZFKFeRGibYRxSnKAG4tLLpL",
            "type": "function",
            "function": {
              "name": "final_result",
              "arguments": "{\"support_advice\": \"[Scrubbed due to 'auth']\", \"block_card\": true, \"risk\": 8}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:40.860Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"[Scrubbed due to 'auth']\", \"block_card\": true, \"risk\": 8}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"I just lost my card!\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_iGsWue0c62iPNIURBwbzOTtO\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_iGsWue0c62iPNIURBwbzOTtO\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_8ZFKFeRGibYRxSnKAG4tLLpL\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\": \\\"[Scrubbed due to 'auth']\\\", \\\"block_card\\\": true, \\\"risk\\\": 8}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_8ZFKFeRGibYRxSnKAG4tLLpL\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "logfire_scrubbed": "[{\"path\": [\"attributes\", \"final_result\", \"support_advice\"], \"matched_substring\": \"auth\"}, {\"path\": [\"attributes\", \"all_messages_events\", 5, \"tool_calls\", 0, \"function\", \"arguments\", \"support_advice\"], \"matched_substring\": \"auth\"}]",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 335,
      "completion": 88
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'John'"
      },
      {
        "role": "user",
        "content": "I just lost my card!"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:43.686Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"[Scrubbed due to 'auth']\", \"block_card\": true, \"risk\": 8}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"I just lost my card!\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_iGsWue0c62iPNIURBwbzOTtO\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_iGsWue0c62iPNIURBwbzOTtO\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_8ZFKFeRGibYRxSnKAG4tLLpL\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\": \\\"[Scrubbed due to 'auth']\\\", \\\"block_card\\\": true, \\\"risk\\\": 8}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_8ZFKFeRGibYRxSnKAG4tLLpL\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "logfire_scrubbed": "[{\"path\": [\"attributes\", \"final_result\", \"support_advice\"], \"matched_substring\": \"auth\"}, {\"path\": [\"attributes\", \"all_messages_events\", 5, \"tool_calls\", 0, \"function\", \"arguments\", \"support_advice\"], \"matched_substring\": \"auth\"}]",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2825.764
    },
    "tokensUsage": {
      "prompt": 335,
      "completion": 88
    },
    "output": "{\"support_advice\": \"[Scrubbed due to 'auth']\", \"block_card\": true, \"risk\": 8}"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "fe88ee0e-3673-4053-9b6d-661f941bdb54",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:43.688Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Jane'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Can you tell me my current balance including pending transactions?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_twSIGlBmLahirglimxqhEuS7\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 159,
      "completion": 15
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'Jane'"
      },
      {
        "role": "user",
        "content": "Can you tell me my current balance including pending transactions?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "fe88ee0e-3673-4053-9b6d-661f941bdb54",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:44.388Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Jane'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Can you tell me my current balance including pending transactions?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_twSIGlBmLahirglimxqhEuS7\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 699.743
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 159,
      "completion": 15
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_twSIGlBmLahirglimxqhEuS7",
            "type": "function",
            "function": {
              "name": "customer_balance",
              "arguments": "{\"include_pending\":true}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "494c9da4-e365-4750-bae2-ea351ccffc53",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:44.388Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_twSIGlBmLahirglimxqhEuS7",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "include_pending": true
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "494c9da4-e365-4750-bae2-ea351ccffc53",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:44.389Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_twSIGlBmLahirglimxqhEuS7",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.142
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "a1670f3d-f5ec-4af9-9bf2-98699ec18e8a",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:44.389Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Jane'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Can you tell me my current balance including pending transactions?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_twSIGlBmLahirglimxqhEuS7\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$500.00\", \"role\": \"tool\", \"id\": \"call_twSIGlBmLahirglimxqhEuS7\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_gbcK3QIETwCLx4YcxKODXJzo\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including pending transactions, is $500.00. If you have any other questions or need further assistance, feel free to ask.\\\",\\\"block_card\\\":false,\\\"risk\\\":2}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 186,
      "completion": 54
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'Jane'"
      },
      {
        "role": "user",
        "content": "Can you tell me my current balance including pending transactions?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "a1670f3d-f5ec-4af9-9bf2-98699ec18e8a",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:45.853Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Jane'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Can you tell me my current balance including pending transactions?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_twSIGlBmLahirglimxqhEuS7\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$500.00\", \"role\": \"tool\", \"id\": \"call_twSIGlBmLahirglimxqhEuS7\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_gbcK3QIETwCLx4YcxKODXJzo\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including pending transactions, is $500.00. If you have any other questions or need further assistance, feel free to ask.\\\",\\\"block_card\\\":false,\\\"risk\\\":2}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1463.816
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 186,
      "completion": 54
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_gbcK3QIETwCLx4YcxKODXJzo",
            "type": "function",
            "function": {
              "name": "final_result",
              "arguments": "{\"support_advice\":\"Your current account balance, including pending transactions, is $500.00. If you have any other questions or need further assistance, feel free to ask.\",\"block_card\":false,\"risk\":2}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "a8412b9d-81a3-45a0-8cf3-0c25b80ffa3c",
    "timestamp": "2025-06-26T08:32:43.687Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"Your current account balance, including pending transactions, is $500.00. If you have any other questions or need further assistance, feel free to ask.\", \"block_card\": false, \"risk\": 2}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Jane'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Can you tell me my current balance including pending transactions?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_twSIGlBmLahirglimxqhEuS7\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$500.00\", \"role\": \"tool\", \"id\": \"call_twSIGlBmLahirglimxqhEuS7\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_gbcK3QIETwCLx4YcxKODXJzo\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including pending transactions, is $500.00. If you have any other questions or need further assistance, feel free to ask.\\\",\\\"block_card\\\":false,\\\"risk\\\":2}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_gbcK3QIETwCLx4YcxKODXJzo\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 345,
      "completion": 69
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'Jane'"
      },
      {
        "role": "user",
        "content": "Can you tell me my current balance including pending transactions?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "a8412b9d-81a3-45a0-8cf3-0c25b80ffa3c",
    "timestamp": "2025-06-26T08:32:45.854Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"Your current account balance, including pending transactions, is $500.00. If you have any other questions or need further assistance, feel free to ask.\", \"block_card\": false, \"risk\": 2}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Jane'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Can you tell me my current balance including pending transactions?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_twSIGlBmLahirglimxqhEuS7\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$500.00\", \"role\": \"tool\", \"id\": \"call_twSIGlBmLahirglimxqhEuS7\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_gbcK3QIETwCLx4YcxKODXJzo\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including pending transactions, is $500.00. If you have any other questions or need further assistance, feel free to ask.\\\",\\\"block_card\\\":false,\\\"risk\\\":2}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_gbcK3QIETwCLx4YcxKODXJzo\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2166.331
    },
    "tokensUsage": {
      "prompt": 345,
      "completion": 69
    },
    "output": "{\"support_advice\": \"Your current account balance, including pending transactions, is $500.00. If you have any other questions or need further assistance, feel free to ask.\", \"block_card\": false, \"risk\": 2}"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "230b608f-d3e0-40c2-aad6-a97805939aac",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:45.855Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Bob'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Why is my account overdrawn?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_O6pKRFjbDqcVeWGdc0CVCCAG\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 156,
      "completion": 15
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'Bob'"
      },
      {
        "role": "user",
        "content": "Why is my account overdrawn?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "230b608f-d3e0-40c2-aad6-a97805939aac",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:46.609Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Bob'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Why is my account overdrawn?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_O6pKRFjbDqcVeWGdc0CVCCAG\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 753.809
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 156,
      "completion": 15
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_O6pKRFjbDqcVeWGdc0CVCCAG",
            "type": "function",
            "function": {
              "name": "customer_balance",
              "arguments": "{\"include_pending\":true}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "75de26e2-259e-4006-a255-050ff8a3f4f5",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:46.609Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_O6pKRFjbDqcVeWGdc0CVCCAG",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "include_pending": true
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "75de26e2-259e-4006-a255-050ff8a3f4f5",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:46.609Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_O6pKRFjbDqcVeWGdc0CVCCAG",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.119
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "5382c291-f496-4b28-86e5-04f421e7abba",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:46.610Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Bob'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Why is my account overdrawn?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_O6pKRFjbDqcVeWGdc0CVCCAG\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$-50.00\", \"role\": \"tool\", \"id\": \"call_O6pKRFjbDqcVeWGdc0CVCCAG\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_z1gUnQxI2VIuuQRynwcnI6PU\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your account is overdrawn by $50.00, which may be due to pending transactions or fees. Please review your recent transactions or contact us if you need further assistance.\\\",\\\"block_card\\\":false,\\\"risk\\\":4}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 184,
      "completion": 59
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'Bob'"
      },
      {
        "role": "user",
        "content": "Why is my account overdrawn?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "5382c291-f496-4b28-86e5-04f421e7abba",
    "parentRunId": "95152469-103c-4310-b008-56e5afdd270d",
    "timestamp": "2025-06-26T08:32:49.212Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Bob'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Why is my account overdrawn?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_O6pKRFjbDqcVeWGdc0CVCCAG\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$-50.00\", \"role\": \"tool\", \"id\": \"call_O6pKRFjbDqcVeWGdc0CVCCAG\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_z1gUnQxI2VIuuQRynwcnI6PU\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your account is overdrawn by $50.00, which may be due to pending transactions or fees. Please review your recent transactions or contact us if you need further assistance.\\\",\\\"block_card\\\":false,\\\"risk\\\":4}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2602.603
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 184,
      "completion": 59
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_z1gUnQxI2VIuuQRynwcnI6PU",
            "type": "function",
            "function": {
              "name": "final_result",
              "arguments": "{\"support_advice\":\"Your account is overdrawn by $50.00, which may be due to pending transactions or fees. Please review your recent transactions or contact us if you need further assistance.\",\"block_card\":false,\"risk\":4}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "173c4127-97db-4d32-9ccf-aa77679bccbb",
    "timestamp": "2025-06-26T08:32:45.854Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"Your account is overdrawn by $50.00, which may be due to pending transactions or fees. Please review your recent transactions or contact us if you need further assistance.\", \"block_card\": false, \"risk\": 4}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Bob'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Why is my account overdrawn?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_O6pKRFjbDqcVeWGdc0CVCCAG\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$-50.00\", \"role\": \"tool\", \"id\": \"call_O6pKRFjbDqcVeWGdc0CVCCAG\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_z1gUnQxI2VIuuQRynwcnI6PU\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your account is overdrawn by $50.00, which may be due to pending transactions or fees. Please review your recent transactions or contact us if you need further assistance.\\\",\\\"block_card\\\":false,\\\"risk\\\":4}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_z1gUnQxI2VIuuQRynwcnI6PU\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 340,
      "completion": 74
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'Bob'"
      },
      {
        "role": "user",
        "content": "Why is my account overdrawn?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "173c4127-97db-4d32-9ccf-aa77679bccbb",
    "timestamp": "2025-06-26T08:32:49.213Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"Your account is overdrawn by $50.00, which may be due to pending transactions or fees. Please review your recent transactions or contact us if you need further assistance.\", \"block_card\": false, \"risk\": 4}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Bob'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Why is my account overdrawn?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_O6pKRFjbDqcVeWGdc0CVCCAG\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$-50.00\", \"role\": \"tool\", \"id\": \"call_O6pKRFjbDqcVeWGdc0CVCCAG\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_z1gUnQxI2VIuuQRynwcnI6PU\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your account is overdrawn by $50.00, which may be due to pending transactions or fees. Please review your recent transactions or contact us if you need further assistance.\\\",\\\"block_card\\\":false,\\\"risk\\\":4}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_z1gUnQxI2VIuuQRynwcnI6PU\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 3358.652
    },
    "tokensUsage": {
      "prompt": 340,
      "completion": 74
    },
    "output": "{\"support_advice\": \"Your account is overdrawn by $50.00, which may be due to pending transactions or fees. Please review your recent transactions or contact us if you need further assistance.\", \"block_card\": false, \"risk\": 4}"
  }
]
Using project key: 07ff18c9-f052-4260-9e89-ea93fe9ba8c5
âœ… Successfully forwarded to backend

ðŸ”­ Received traces: 1 ResourceSpans
Resource attributes: {
  "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
  "telemetry.sdk.language": "python",
  "telemetry.sdk.name": "opentelemetry",
  "telemetry.sdk.version": "1.34.1",
  "service.name": "lunary-bank-support",
  "process.pid": 24555,
  "process.runtime.name": "cpython",
  "process.runtime.version": "3.13.5",
  "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
  "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
}
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span agent run -> 2 events

ðŸ”§ Fixing parent-child relationships...
Before fix:
- llm dc2bc45f-8334-42a3-82cd-cfe4cb6d3b51 parent: db2544dd-1ea7-41b1-9863-18f76b00b7fd
- llm dc2bc45f-8334-42a3-82cd-cfe4cb6d3b51 parent: db2544dd-1ea7-41b1-9863-18f76b00b7fd
- tool c45c6d1d-b44d-4a56-84dd-ad95c3c6c529 parent: 6904f724-90d8-4672-983c-6403a1ee0893
- tool c45c6d1d-b44d-4a56-84dd-ad95c3c6c529 parent: 6904f724-90d8-4672-983c-6403a1ee0893
- agent bb33a8a3-7c4d-49b2-b040-1daf549f2b95 parent: none
- agent bb33a8a3-7c4d-49b2-b040-1daf549f2b95 parent: none

After fix:
- llm dc2bc45f-8334-42a3-82cd-cfe4cb6d3b51 parent: bb33a8a3-7c4d-49b2-b040-1daf549f2b95
- llm dc2bc45f-8334-42a3-82cd-cfe4cb6d3b51 parent: bb33a8a3-7c4d-49b2-b040-1daf549f2b95
- tool c45c6d1d-b44d-4a56-84dd-ad95c3c6c529 parent: bb33a8a3-7c4d-49b2-b040-1daf549f2b95
- tool c45c6d1d-b44d-4a56-84dd-ad95c3c6c529 parent: bb33a8a3-7c4d-49b2-b040-1daf549f2b95
- agent bb33a8a3-7c4d-49b2-b040-1daf549f2b95 parent: none
- agent bb33a8a3-7c4d-49b2-b040-1daf549f2b95 parent: none

ðŸ“¥ Forwarding 6 events to backend
Events: [
  {
    "type": "llm",
    "event": "start",
    "runId": "dc2bc45f-8334-42a3-82cd-cfe4cb6d3b51",
    "parentRunId": "bb33a8a3-7c4d-49b2-b040-1daf549f2b95",
    "timestamp": "2025-06-26T08:32:49.214Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is None\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_4Can1Zqbdjo44B4OXzFPqJc5\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 151,
      "completion": 15
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is None"
      },
      {
        "role": "user",
        "content": "What is my balance?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "dc2bc45f-8334-42a3-82cd-cfe4cb6d3b51",
    "parentRunId": "bb33a8a3-7c4d-49b2-b040-1daf549f2b95",
    "timestamp": "2025-06-26T08:32:50.046Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is None\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_4Can1Zqbdjo44B4OXzFPqJc5\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 831.649
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 151,
      "completion": 15
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_4Can1Zqbdjo44B4OXzFPqJc5",
            "type": "function",
            "function": {
              "name": "customer_balance",
              "arguments": "{\"include_pending\":true}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "c45c6d1d-b44d-4a56-84dd-ad95c3c6c529",
    "parentRunId": "bb33a8a3-7c4d-49b2-b040-1daf549f2b95",
    "timestamp": "2025-06-26T08:32:50.047Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_4Can1Zqbdjo44B4OXzFPqJc5",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "logfire_level_num": 17,
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "include_pending": true
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "c45c6d1d-b44d-4a56-84dd-ad95c3c6c529",
    "parentRunId": "bb33a8a3-7c4d-49b2-b040-1daf549f2b95",
    "timestamp": "2025-06-26T08:32:50.052Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_4Can1Zqbdjo44B4OXzFPqJc5",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "logfire_level_num": 17,
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 5.672
    },
    "output": "Tool executed successfully",
    "level": "error",
    "error": {
      "code": 2,
      "message": "ValueError: Customer not found"
    }
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "bb33a8a3-7c4d-49b2-b040-1daf549f2b95",
    "timestamp": "2025-06-26T08:32:49.214Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is None\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_4Can1Zqbdjo44B4OXzFPqJc5\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "logfire_level_num": 17,
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 151,
      "completion": 15
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is None"
      },
      {
        "role": "user",
        "content": "What is my balance?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "bb33a8a3-7c4d-49b2-b040-1daf549f2b95",
    "timestamp": "2025-06-26T08:32:50.059Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is None\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_4Can1Zqbdjo44B4OXzFPqJc5\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "logfire_level_num": 17,
      "service.instance.id": "9fa8a8f2d8e84a51b654545efe46052c",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 24555,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 844.76
    },
    "tokensUsage": {
      "prompt": 151,
      "completion": 15
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_4Can1Zqbdjo44B4OXzFPqJc5",
            "type": "function",
            "function": {
              "name": "customer_balance",
              "arguments": "{\"include_pending\":true}"
            }
          }
        ]
      }
    ],
    "level": "error",
    "error": {
      "code": 2,
      "message": "ValueError: Customer not found"
    }
  }
]
Using project key: 07ff18c9-f052-4260-9e89-ea93fe9ba8c5
âœ… Successfully forwarded to backend
ðŸ“Š metrics: 1 ResourceMetrics

ðŸ”­ Received traces: 1 ResourceSpans
Resource attributes: {
  "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
  "telemetry.sdk.language": "python",
  "telemetry.sdk.name": "opentelemetry",
  "telemetry.sdk.version": "1.34.1",
  "service.name": "lunary-bank-support",
  "process.pid": 25101,
  "process.runtime.name": "cpython",
  "process.runtime.version": "3.13.5",
  "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
  "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
}
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events

ðŸ”§ Fixing parent-child relationships...
Before fix:
- llm 7bd693bd-5249-4c2a-9371-99b1c816f5b9 parent: 32431a0c-b3b7-4813-831c-7c9bd00b8a69
- llm 7bd693bd-5249-4c2a-9371-99b1c816f5b9 parent: 32431a0c-b3b7-4813-831c-7c9bd00b8a69
- tool 990720f3-54df-44eb-b664-d6498d1d37a1 parent: 0398a88e-b303-4047-8a35-ab518ce91549
- tool 990720f3-54df-44eb-b664-d6498d1d37a1 parent: 0398a88e-b303-4047-8a35-ab518ce91549
- llm d6bd2d10-21e0-4695-bfeb-49cb4e0a72bd parent: 98d8da90-3a55-4ced-858e-50100dc0d795
- llm d6bd2d10-21e0-4695-bfeb-49cb4e0a72bd parent: 98d8da90-3a55-4ced-858e-50100dc0d795
- agent fc7f88e0-6024-4075-bb20-4a3e0e250f83 parent: none
- agent fc7f88e0-6024-4075-bb20-4a3e0e250f83 parent: none
- llm 2c0cffdd-7e9c-4fef-9f52-23f5cc1363ad parent: 1827af17-a67d-4219-8f56-04ea5d5b7559
- llm 2c0cffdd-7e9c-4fef-9f52-23f5cc1363ad parent: 1827af17-a67d-4219-8f56-04ea5d5b7559
- tool 5a32c6bc-da30-4fc0-b493-74b1f48b507c parent: 27aee2a1-f5c4-4aca-b63d-6c2125689516
- tool 5a32c6bc-da30-4fc0-b493-74b1f48b507c parent: 27aee2a1-f5c4-4aca-b63d-6c2125689516

After fix:
- llm 7bd693bd-5249-4c2a-9371-99b1c816f5b9 parent: fc7f88e0-6024-4075-bb20-4a3e0e250f83
- llm 7bd693bd-5249-4c2a-9371-99b1c816f5b9 parent: fc7f88e0-6024-4075-bb20-4a3e0e250f83
- tool 990720f3-54df-44eb-b664-d6498d1d37a1 parent: fc7f88e0-6024-4075-bb20-4a3e0e250f83
- tool 990720f3-54df-44eb-b664-d6498d1d37a1 parent: fc7f88e0-6024-4075-bb20-4a3e0e250f83
- llm d6bd2d10-21e0-4695-bfeb-49cb4e0a72bd parent: fc7f88e0-6024-4075-bb20-4a3e0e250f83
- llm d6bd2d10-21e0-4695-bfeb-49cb4e0a72bd parent: fc7f88e0-6024-4075-bb20-4a3e0e250f83
- agent fc7f88e0-6024-4075-bb20-4a3e0e250f83 parent: none
- agent fc7f88e0-6024-4075-bb20-4a3e0e250f83 parent: none
- llm 2c0cffdd-7e9c-4fef-9f52-23f5cc1363ad parent: fc7f88e0-6024-4075-bb20-4a3e0e250f83
- llm 2c0cffdd-7e9c-4fef-9f52-23f5cc1363ad parent: fc7f88e0-6024-4075-bb20-4a3e0e250f83
- tool 5a32c6bc-da30-4fc0-b493-74b1f48b507c parent: fc7f88e0-6024-4075-bb20-4a3e0e250f83
- tool 5a32c6bc-da30-4fc0-b493-74b1f48b507c parent: fc7f88e0-6024-4075-bb20-4a3e0e250f83

ðŸ“¥ Forwarding 12 events to backend
Events: [
  {
    "type": "llm",
    "event": "start",
    "runId": "7bd693bd-5249-4c2a-9371-99b1c816f5b9",
    "parentRunId": "fc7f88e0-6024-4075-bb20-4a3e0e250f83",
    "timestamp": "2025-06-26T08:36:58.232Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_fwpyqciDHVh5Vfj7ylsoQKeh\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 153,
      "completion": 15
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'John'"
      },
      {
        "role": "user",
        "content": "What is my balance?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "7bd693bd-5249-4c2a-9371-99b1c816f5b9",
    "parentRunId": "fc7f88e0-6024-4075-bb20-4a3e0e250f83",
    "timestamp": "2025-06-26T08:37:00.047Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_fwpyqciDHVh5Vfj7ylsoQKeh\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1815.712
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 153,
      "completion": 15
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_fwpyqciDHVh5Vfj7ylsoQKeh",
            "type": "function",
            "function": {
              "name": "customer_balance",
              "arguments": "{\"include_pending\":true}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "990720f3-54df-44eb-b664-d6498d1d37a1",
    "parentRunId": "fc7f88e0-6024-4075-bb20-4a3e0e250f83",
    "timestamp": "2025-06-26T08:37:00.050Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_fwpyqciDHVh5Vfj7ylsoQKeh",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "include_pending": true
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "990720f3-54df-44eb-b664-d6498d1d37a1",
    "parentRunId": "fc7f88e0-6024-4075-bb20-4a3e0e250f83",
    "timestamp": "2025-06-26T08:37:00.051Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_fwpyqciDHVh5Vfj7ylsoQKeh",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.859
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "d6bd2d10-21e0-4695-bfeb-49cb4e0a72bd",
    "parentRunId": "fc7f88e0-6024-4075-bb20-4a3e0e250f83",
    "timestamp": "2025-06-26T08:37:00.052Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_fwpyqciDHVh5Vfj7ylsoQKeh\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_fwpyqciDHVh5Vfj7ylsoQKeh\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_oYNAiAUxrnYUL5SowbgUSANW\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including any pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\\\",\\\"block_card\\\":false,\\\"risk\\\":1}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 180,
      "completion": 56
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'John'"
      },
      {
        "role": "user",
        "content": "What is my balance?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "d6bd2d10-21e0-4695-bfeb-49cb4e0a72bd",
    "parentRunId": "fc7f88e0-6024-4075-bb20-4a3e0e250f83",
    "timestamp": "2025-06-26T08:37:01.584Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_fwpyqciDHVh5Vfj7ylsoQKeh\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_fwpyqciDHVh5Vfj7ylsoQKeh\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_oYNAiAUxrnYUL5SowbgUSANW\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including any pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\\\",\\\"block_card\\\":false,\\\"risk\\\":1}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1532.512
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 180,
      "completion": 56
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_oYNAiAUxrnYUL5SowbgUSANW",
            "type": "function",
            "function": {
              "name": "final_result",
              "arguments": "{\"support_advice\":\"Your current account balance, including any pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\",\"block_card\":false,\"risk\":1}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "fc7f88e0-6024-4075-bb20-4a3e0e250f83",
    "timestamp": "2025-06-26T08:36:58.227Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"Your current account balance, including any pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\", \"block_card\": false, \"risk\": 1}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_fwpyqciDHVh5Vfj7ylsoQKeh\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_fwpyqciDHVh5Vfj7ylsoQKeh\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_oYNAiAUxrnYUL5SowbgUSANW\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including any pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\\\",\\\"block_card\\\":false,\\\"risk\\\":1}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_oYNAiAUxrnYUL5SowbgUSANW\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 333,
      "completion": 71
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'John'"
      },
      {
        "role": "user",
        "content": "What is my balance?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "fc7f88e0-6024-4075-bb20-4a3e0e250f83",
    "timestamp": "2025-06-26T08:37:01.585Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"Your current account balance, including any pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\", \"block_card\": false, \"risk\": 1}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_fwpyqciDHVh5Vfj7ylsoQKeh\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_fwpyqciDHVh5Vfj7ylsoQKeh\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_oYNAiAUxrnYUL5SowbgUSANW\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including any pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\\\",\\\"block_card\\\":false,\\\"risk\\\":1}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_oYNAiAUxrnYUL5SowbgUSANW\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 3357.891
    },
    "tokensUsage": {
      "prompt": 333,
      "completion": 71
    },
    "output": "{\"support_advice\": \"Your current account balance, including any pending transactions, is $123.45. If you have any other questions or need further assistance, feel free to ask!\", \"block_card\": false, \"risk\": 1}"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "2c0cffdd-7e9c-4fef-9f52-23f5cc1363ad",
    "parentRunId": "fc7f88e0-6024-4075-bb20-4a3e0e250f83",
    "timestamp": "2025-06-26T08:37:01.587Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"I just lost my card!\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zupF8Op1MDF9sLzxa2Pdnm4J\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 154,
      "completion": 15
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'John'"
      },
      {
        "role": "user",
        "content": "I just lost my card!"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "2c0cffdd-7e9c-4fef-9f52-23f5cc1363ad",
    "parentRunId": "fc7f88e0-6024-4075-bb20-4a3e0e250f83",
    "timestamp": "2025-06-26T08:37:02.257Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"I just lost my card!\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zupF8Op1MDF9sLzxa2Pdnm4J\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 670.632
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 154,
      "completion": 15
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_zupF8Op1MDF9sLzxa2Pdnm4J",
            "type": "function",
            "function": {
              "name": "customer_balance",
              "arguments": "{\"include_pending\":true}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "5a32c6bc-da30-4fc0-b493-74b1f48b507c",
    "parentRunId": "fc7f88e0-6024-4075-bb20-4a3e0e250f83",
    "timestamp": "2025-06-26T08:37:02.258Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_zupF8Op1MDF9sLzxa2Pdnm4J",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "include_pending": true
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "5a32c6bc-da30-4fc0-b493-74b1f48b507c",
    "parentRunId": "fc7f88e0-6024-4075-bb20-4a3e0e250f83",
    "timestamp": "2025-06-26T08:37:02.259Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_zupF8Op1MDF9sLzxa2Pdnm4J",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.261
    },
    "output": "Tool executed successfully"
  }
]
Using project key: 07ff18c9-f052-4260-9e89-ea93fe9ba8c5
âœ… Successfully forwarded to backend

ðŸ”­ Received traces: 1 ResourceSpans
Resource attributes: {
  "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
  "telemetry.sdk.language": "python",
  "telemetry.sdk.name": "opentelemetry",
  "telemetry.sdk.version": "1.34.1",
  "service.name": "lunary-bank-support",
  "process.pid": 25101,
  "process.runtime.name": "cpython",
  "process.runtime.version": "3.13.5",
  "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
  "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
}
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span chat gpt-4o -> 2 events
Processing span agent run -> 2 events

ðŸ”§ Fixing parent-child relationships...
Before fix:
- llm 91848c5f-1068-431a-b48d-44ccdeb2b8dc parent: 8b702589-2978-45cf-8076-c716189b704c
- llm 91848c5f-1068-431a-b48d-44ccdeb2b8dc parent: 8b702589-2978-45cf-8076-c716189b704c
- agent 2bf29676-a336-464e-9010-d1263bc06ae6 parent: none
- agent 2bf29676-a336-464e-9010-d1263bc06ae6 parent: none
- llm fe8aad04-841b-405c-ad11-d7f483bf3853 parent: c4b5218a-0f68-4236-982d-59f57649d6a4
- llm fe8aad04-841b-405c-ad11-d7f483bf3853 parent: c4b5218a-0f68-4236-982d-59f57649d6a4
- tool 52d96c45-ba34-4f15-960c-e3391ff0aef7 parent: d6b321bd-382e-4c20-8a8b-abe9ae30c329
- tool 52d96c45-ba34-4f15-960c-e3391ff0aef7 parent: d6b321bd-382e-4c20-8a8b-abe9ae30c329
- llm 624e22fd-6605-4d99-9e96-352b5fb01867 parent: f6861995-d843-41f4-bdef-57d7be4eb7f0
- llm 624e22fd-6605-4d99-9e96-352b5fb01867 parent: f6861995-d843-41f4-bdef-57d7be4eb7f0
- agent 49d53c1d-1ceb-44a2-adf9-8073520dece8 parent: none
- agent 49d53c1d-1ceb-44a2-adf9-8073520dece8 parent: none
- llm d5199e40-30a2-443a-8bdc-52541b504af1 parent: ddb8cd64-647f-4572-a79d-484c7c5c2e26
- llm d5199e40-30a2-443a-8bdc-52541b504af1 parent: ddb8cd64-647f-4572-a79d-484c7c5c2e26
- tool 94871d22-0485-49e7-a9a9-b67dc922af1a parent: 34a1fc65-22cd-41a9-8f9c-a13436c13ada
- tool 94871d22-0485-49e7-a9a9-b67dc922af1a parent: 34a1fc65-22cd-41a9-8f9c-a13436c13ada
- llm ec46cdb2-f926-435f-b42a-df657b6a8804 parent: 9aa72120-94cd-47e3-85dd-ddf838fb5737
- llm ec46cdb2-f926-435f-b42a-df657b6a8804 parent: 9aa72120-94cd-47e3-85dd-ddf838fb5737
- agent 5d97909f-94f5-4b83-a07c-011c756153ca parent: none
- agent 5d97909f-94f5-4b83-a07c-011c756153ca parent: none

After fix:
- llm 91848c5f-1068-431a-b48d-44ccdeb2b8dc parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- llm 91848c5f-1068-431a-b48d-44ccdeb2b8dc parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- agent 2bf29676-a336-464e-9010-d1263bc06ae6 parent: none
- agent 2bf29676-a336-464e-9010-d1263bc06ae6 parent: none
- llm fe8aad04-841b-405c-ad11-d7f483bf3853 parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- llm fe8aad04-841b-405c-ad11-d7f483bf3853 parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- tool 52d96c45-ba34-4f15-960c-e3391ff0aef7 parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- tool 52d96c45-ba34-4f15-960c-e3391ff0aef7 parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- llm 624e22fd-6605-4d99-9e96-352b5fb01867 parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- llm 624e22fd-6605-4d99-9e96-352b5fb01867 parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- agent 49d53c1d-1ceb-44a2-adf9-8073520dece8 parent: none
- agent 49d53c1d-1ceb-44a2-adf9-8073520dece8 parent: none
- llm d5199e40-30a2-443a-8bdc-52541b504af1 parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- llm d5199e40-30a2-443a-8bdc-52541b504af1 parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- tool 94871d22-0485-49e7-a9a9-b67dc922af1a parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- tool 94871d22-0485-49e7-a9a9-b67dc922af1a parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- llm ec46cdb2-f926-435f-b42a-df657b6a8804 parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- llm ec46cdb2-f926-435f-b42a-df657b6a8804 parent: 2bf29676-a336-464e-9010-d1263bc06ae6
- agent 5d97909f-94f5-4b83-a07c-011c756153ca parent: none
- agent 5d97909f-94f5-4b83-a07c-011c756153ca parent: none

ðŸ“¥ Forwarding 20 events to backend
Events: [
  {
    "type": "llm",
    "event": "start",
    "runId": "91848c5f-1068-431a-b48d-44ccdeb2b8dc",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:02.259Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"I just lost my card!\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zupF8Op1MDF9sLzxa2Pdnm4J\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_zupF8Op1MDF9sLzxa2Pdnm4J\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_l1pX5dFSPTUonZobXlGhZ6qD\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\": \\\"[Scrubbed due to 'auth']\\\", \\\"block_card\\\": true, \\\"risk\\\": 8}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "logfire_scrubbed": "[{\"path\": [\"attributes\", \"events\", 5, \"message\", \"tool_calls\", 0, \"function\", \"arguments\", \"support_advice\"], \"matched_substring\": \"auth\"}]",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 181,
      "completion": 83
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'John'"
      },
      {
        "role": "user",
        "content": "I just lost my card!"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "91848c5f-1068-431a-b48d-44ccdeb2b8dc",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:04.065Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"I just lost my card!\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zupF8Op1MDF9sLzxa2Pdnm4J\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_zupF8Op1MDF9sLzxa2Pdnm4J\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_l1pX5dFSPTUonZobXlGhZ6qD\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\": \\\"[Scrubbed due to 'auth']\\\", \\\"block_card\\\": true, \\\"risk\\\": 8}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "logfire_scrubbed": "[{\"path\": [\"attributes\", \"events\", 5, \"message\", \"tool_calls\", 0, \"function\", \"arguments\", \"support_advice\"], \"matched_substring\": \"auth\"}]",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1806.043
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 181,
      "completion": 83
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_l1pX5dFSPTUonZobXlGhZ6qD",
            "type": "function",
            "function": {
              "name": "final_result",
              "arguments": "{\"support_advice\": \"[Scrubbed due to 'auth']\", \"block_card\": true, \"risk\": 8}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:01.586Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"[Scrubbed due to 'auth']\", \"block_card\": true, \"risk\": 8}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"I just lost my card!\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zupF8Op1MDF9sLzxa2Pdnm4J\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_zupF8Op1MDF9sLzxa2Pdnm4J\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_l1pX5dFSPTUonZobXlGhZ6qD\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\": \\\"[Scrubbed due to 'auth']\\\", \\\"block_card\\\": true, \\\"risk\\\": 8}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_l1pX5dFSPTUonZobXlGhZ6qD\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "logfire_scrubbed": "[{\"path\": [\"attributes\", \"final_result\", \"support_advice\"], \"matched_substring\": \"auth\"}, {\"path\": [\"attributes\", \"all_messages_events\", 5, \"tool_calls\", 0, \"function\", \"arguments\", \"support_advice\"], \"matched_substring\": \"auth\"}]",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 335,
      "completion": 98
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'John'"
      },
      {
        "role": "user",
        "content": "I just lost my card!"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:04.066Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"[Scrubbed due to 'auth']\", \"block_card\": true, \"risk\": 8}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'John'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"I just lost my card!\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_zupF8Op1MDF9sLzxa2Pdnm4J\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$123.45\", \"role\": \"tool\", \"id\": \"call_zupF8Op1MDF9sLzxa2Pdnm4J\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_l1pX5dFSPTUonZobXlGhZ6qD\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\": \\\"[Scrubbed due to 'auth']\\\", \\\"block_card\\\": true, \\\"risk\\\": 8}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_l1pX5dFSPTUonZobXlGhZ6qD\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "logfire_scrubbed": "[{\"path\": [\"attributes\", \"final_result\", \"support_advice\"], \"matched_substring\": \"auth\"}, {\"path\": [\"attributes\", \"all_messages_events\", 5, \"tool_calls\", 0, \"function\", \"arguments\", \"support_advice\"], \"matched_substring\": \"auth\"}]",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2480.026
    },
    "tokensUsage": {
      "prompt": 335,
      "completion": 98
    },
    "output": "{\"support_advice\": \"[Scrubbed due to 'auth']\", \"block_card\": true, \"risk\": 8}"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "fe8aad04-841b-405c-ad11-d7f483bf3853",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:04.068Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Jane'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Can you tell me my current balance including pending transactions?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_Cq1DissVq5Wmfiw0ikvA5BuV\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 159,
      "completion": 15
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'Jane'"
      },
      {
        "role": "user",
        "content": "Can you tell me my current balance including pending transactions?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "fe8aad04-841b-405c-ad11-d7f483bf3853",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:04.763Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Jane'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Can you tell me my current balance including pending transactions?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_Cq1DissVq5Wmfiw0ikvA5BuV\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 695.042
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 159,
      "completion": 15
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_Cq1DissVq5Wmfiw0ikvA5BuV",
            "type": "function",
            "function": {
              "name": "customer_balance",
              "arguments": "{\"include_pending\":true}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "52d96c45-ba34-4f15-960c-e3391ff0aef7",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:04.764Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_Cq1DissVq5Wmfiw0ikvA5BuV",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "include_pending": true
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "52d96c45-ba34-4f15-960c-e3391ff0aef7",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:04.764Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_Cq1DissVq5Wmfiw0ikvA5BuV",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.251
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "624e22fd-6605-4d99-9e96-352b5fb01867",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:04.765Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Jane'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Can you tell me my current balance including pending transactions?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_Cq1DissVq5Wmfiw0ikvA5BuV\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$500.00\", \"role\": \"tool\", \"id\": \"call_Cq1DissVq5Wmfiw0ikvA5BuV\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_EUU2cp2tjHy3FTQfalrSuXzb\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including pending transactions, is $500.00. If you need to manage your spending or review any transactions, please feel free to do so via our online banking platform.\\\",\\\"block_card\\\":false,\\\"risk\\\":1}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 186,
      "completion": 62
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'Jane'"
      },
      {
        "role": "user",
        "content": "Can you tell me my current balance including pending transactions?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "624e22fd-6605-4d99-9e96-352b5fb01867",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:06.575Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Jane'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Can you tell me my current balance including pending transactions?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_Cq1DissVq5Wmfiw0ikvA5BuV\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$500.00\", \"role\": \"tool\", \"id\": \"call_Cq1DissVq5Wmfiw0ikvA5BuV\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_EUU2cp2tjHy3FTQfalrSuXzb\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including pending transactions, is $500.00. If you need to manage your spending or review any transactions, please feel free to do so via our online banking platform.\\\",\\\"block_card\\\":false,\\\"risk\\\":1}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 1810.525
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 186,
      "completion": 62
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_EUU2cp2tjHy3FTQfalrSuXzb",
            "type": "function",
            "function": {
              "name": "final_result",
              "arguments": "{\"support_advice\":\"Your current account balance, including pending transactions, is $500.00. If you need to manage your spending or review any transactions, please feel free to do so via our online banking platform.\",\"block_card\":false,\"risk\":1}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "49d53c1d-1ceb-44a2-adf9-8073520dece8",
    "timestamp": "2025-06-26T08:37:04.067Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"Your current account balance, including pending transactions, is $500.00. If you need to manage your spending or review any transactions, please feel free to do so via our online banking platform.\", \"block_card\": false, \"risk\": 1}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Jane'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Can you tell me my current balance including pending transactions?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_Cq1DissVq5Wmfiw0ikvA5BuV\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$500.00\", \"role\": \"tool\", \"id\": \"call_Cq1DissVq5Wmfiw0ikvA5BuV\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_EUU2cp2tjHy3FTQfalrSuXzb\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including pending transactions, is $500.00. If you need to manage your spending or review any transactions, please feel free to do so via our online banking platform.\\\",\\\"block_card\\\":false,\\\"risk\\\":1}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_EUU2cp2tjHy3FTQfalrSuXzb\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 345,
      "completion": 77
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'Jane'"
      },
      {
        "role": "user",
        "content": "Can you tell me my current balance including pending transactions?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "49d53c1d-1ceb-44a2-adf9-8073520dece8",
    "timestamp": "2025-06-26T08:37:06.576Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"Your current account balance, including pending transactions, is $500.00. If you need to manage your spending or review any transactions, please feel free to do so via our online banking platform.\", \"block_card\": false, \"risk\": 1}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Jane'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Can you tell me my current balance including pending transactions?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_Cq1DissVq5Wmfiw0ikvA5BuV\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$500.00\", \"role\": \"tool\", \"id\": \"call_Cq1DissVq5Wmfiw0ikvA5BuV\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_EUU2cp2tjHy3FTQfalrSuXzb\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\":\\\"Your current account balance, including pending transactions, is $500.00. If you need to manage your spending or review any transactions, please feel free to do so via our online banking platform.\\\",\\\"block_card\\\":false,\\\"risk\\\":1}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_EUU2cp2tjHy3FTQfalrSuXzb\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2508.773
    },
    "tokensUsage": {
      "prompt": 345,
      "completion": 77
    },
    "output": "{\"support_advice\": \"Your current account balance, including pending transactions, is $500.00. If you need to manage your spending or review any transactions, please feel free to do so via our online banking platform.\", \"block_card\": false, \"risk\": 1}"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "d5199e40-30a2-443a-8bdc-52541b504af1",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:06.577Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Bob'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Why is my account overdrawn?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_UheAclGQitBjATU2MCZpisB5\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 156,
      "completion": 15
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'Bob'"
      },
      {
        "role": "user",
        "content": "Why is my account overdrawn?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "d5199e40-30a2-443a-8bdc-52541b504af1",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:07.302Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Bob'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Why is my account overdrawn?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_UheAclGQitBjATU2MCZpisB5\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 725.073
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 156,
      "completion": 15
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_UheAclGQitBjATU2MCZpisB5",
            "type": "function",
            "function": {
              "name": "customer_balance",
              "arguments": "{\"include_pending\":true}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "94871d22-0485-49e7-a9a9-b67dc922af1a",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:07.303Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_UheAclGQitBjATU2MCZpisB5",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "include_pending": true
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "94871d22-0485-49e7-a9a9-b67dc922af1a",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:07.303Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_UheAclGQitBjATU2MCZpisB5",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 0.206
    },
    "output": "Tool executed successfully"
  },
  {
    "type": "llm",
    "event": "start",
    "runId": "ec46cdb2-f926-435f-b42a-df657b6a8804",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:07.304Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Bob'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Why is my account overdrawn?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_UheAclGQitBjATU2MCZpisB5\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$-50.00\", \"role\": \"tool\", \"id\": \"call_UheAclGQitBjATU2MCZpisB5\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_i2kKEchMeNlSlBboIyHAS5Lc\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\": \\\"[Scrubbed due to 'auth']\\\", \\\"block_card\\\": false, \\\"risk\\\": 3}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "logfire_scrubbed": "[{\"path\": [\"attributes\", \"events\", 5, \"message\", \"tool_calls\", 0, \"function\", \"arguments\", \"support_advice\"], \"matched_substring\": \"auth\"}]",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 184,
      "completion": 90
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'Bob'"
      },
      {
        "role": "user",
        "content": "Why is my account overdrawn?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "ec46cdb2-f926-435f-b42a-df657b6a8804",
    "parentRunId": "2bf29676-a336-464e-9010-d1263bc06ae6",
    "timestamp": "2025-06-26T08:37:09.478Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Bob'\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Why is my account overdrawn?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_UheAclGQitBjATU2MCZpisB5\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$-50.00\", \"role\": \"tool\", \"id\": \"call_UheAclGQitBjATU2MCZpisB5\", \"name\": \"customer_balance\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_i2kKEchMeNlSlBboIyHAS5Lc\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\": \\\"[Scrubbed due to 'auth']\\\", \\\"block_card\\\": false, \\\"risk\\\": 3}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "logfire_scrubbed": "[{\"path\": [\"attributes\", \"events\", 5, \"message\", \"tool_calls\", 0, \"function\", \"arguments\", \"support_advice\"], \"matched_substring\": \"auth\"}]",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2174.018
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 184,
      "completion": 90
    },
    "output": [
      {
        "role": "assistant"
      },
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_i2kKEchMeNlSlBboIyHAS5Lc",
            "type": "function",
            "function": {
              "name": "final_result",
              "arguments": "{\"support_advice\": \"[Scrubbed due to 'auth']\", \"block_card\": false, \"risk\": 3}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "5d97909f-94f5-4b83-a07c-011c756153ca",
    "timestamp": "2025-06-26T08:37:06.577Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"[Scrubbed due to 'auth']\", \"block_card\": false, \"risk\": 3}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Bob'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Why is my account overdrawn?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_UheAclGQitBjATU2MCZpisB5\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$-50.00\", \"role\": \"tool\", \"id\": \"call_UheAclGQitBjATU2MCZpisB5\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_i2kKEchMeNlSlBboIyHAS5Lc\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\": \\\"[Scrubbed due to 'auth']\\\", \\\"block_card\\\": false, \\\"risk\\\": 3}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_i2kKEchMeNlSlBboIyHAS5Lc\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "logfire_scrubbed": "[{\"path\": [\"attributes\", \"final_result\", \"support_advice\"], \"matched_substring\": \"auth\"}, {\"path\": [\"attributes\", \"all_messages_events\", 5, \"tool_calls\", 0, \"function\", \"arguments\", \"support_advice\"], \"matched_substring\": \"auth\"}]",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 340,
      "completion": 105
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is 'Bob'"
      },
      {
        "role": "user",
        "content": "Why is my account overdrawn?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "5d97909f-94f5-4b83-a07c-011c756153ca",
    "timestamp": "2025-06-26T08:37:09.479Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "final_result": "{\"support_advice\": \"[Scrubbed due to 'auth']\", \"block_card\": false, \"risk\": 3}",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is 'Bob'\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"Why is my account overdrawn?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_UheAclGQitBjATU2MCZpisB5\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"$-50.00\", \"role\": \"tool\", \"id\": \"call_UheAclGQitBjATU2MCZpisB5\", \"name\": \"customer_balance\", \"gen_ai.message.index\": 2, \"event.name\": \"gen_ai.tool.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_i2kKEchMeNlSlBboIyHAS5Lc\", \"type\": \"function\", \"function\": {\"name\": \"final_result\", \"arguments\": \"{\\\"support_advice\\\": \\\"[Scrubbed due to 'auth']\\\", \\\"block_card\\\": false, \\\"risk\\\": 3}\"}}], \"gen_ai.message.index\": 3, \"event.name\": \"gen_ai.assistant.message\"}, {\"content\": \"Final result processed.\", \"role\": \"tool\", \"id\": \"call_i2kKEchMeNlSlBboIyHAS5Lc\", \"name\": \"final_result\", \"gen_ai.message.index\": 4, \"event.name\": \"gen_ai.tool.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "logfire_scrubbed": "[{\"path\": [\"attributes\", \"final_result\", \"support_advice\"], \"matched_substring\": \"auth\"}, {\"path\": [\"attributes\", \"all_messages_events\", 5, \"tool_calls\", 0, \"function\", \"arguments\", \"support_advice\"], \"matched_substring\": \"auth\"}]",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 2902.082
    },
    "tokensUsage": {
      "prompt": 340,
      "completion": 105
    },
    "output": "{\"support_advice\": \"[Scrubbed due to 'auth']\", \"block_card\": false, \"risk\": 3}"
  }
]
Using project key: 07ff18c9-f052-4260-9e89-ea93fe9ba8c5
âœ… Successfully forwarded to backend

ðŸ”­ Received traces: 1 ResourceSpans
Resource attributes: {
  "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
  "telemetry.sdk.language": "python",
  "telemetry.sdk.name": "opentelemetry",
  "telemetry.sdk.version": "1.34.1",
  "service.name": "lunary-bank-support",
  "process.pid": 25101,
  "process.runtime.name": "cpython",
  "process.runtime.version": "3.13.5",
  "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
  "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
}
Processing span chat gpt-4o -> 2 events
Processing span running tool -> 2 events
Skipping orchestration span by name: running tools
Processing span running tools -> 0 events
Processing span agent run -> 2 events

ðŸ”§ Fixing parent-child relationships...
Before fix:
- llm 9ea1375e-47fc-46e2-b8d1-d00d1bc383a9 parent: e3d66936-c18e-4b73-a170-346687ea9a86
- llm 9ea1375e-47fc-46e2-b8d1-d00d1bc383a9 parent: e3d66936-c18e-4b73-a170-346687ea9a86
- tool 9af9d1c6-32f4-4868-9731-a863cb24158b parent: 37959281-32a1-4dce-bb41-501afa4fdd5f
- tool 9af9d1c6-32f4-4868-9731-a863cb24158b parent: 37959281-32a1-4dce-bb41-501afa4fdd5f
- agent bff9cc64-abb2-4312-b51d-9beb9e37d226 parent: none
- agent bff9cc64-abb2-4312-b51d-9beb9e37d226 parent: none

After fix:
- llm 9ea1375e-47fc-46e2-b8d1-d00d1bc383a9 parent: bff9cc64-abb2-4312-b51d-9beb9e37d226
- llm 9ea1375e-47fc-46e2-b8d1-d00d1bc383a9 parent: bff9cc64-abb2-4312-b51d-9beb9e37d226
- tool 9af9d1c6-32f4-4868-9731-a863cb24158b parent: bff9cc64-abb2-4312-b51d-9beb9e37d226
- tool 9af9d1c6-32f4-4868-9731-a863cb24158b parent: bff9cc64-abb2-4312-b51d-9beb9e37d226
- agent bff9cc64-abb2-4312-b51d-9beb9e37d226 parent: none
- agent bff9cc64-abb2-4312-b51d-9beb9e37d226 parent: none

ðŸ“¥ Forwarding 6 events to backend
Events: [
  {
    "type": "llm",
    "event": "start",
    "runId": "9ea1375e-47fc-46e2-b8d1-d00d1bc383a9",
    "parentRunId": "bff9cc64-abb2-4312-b51d-9beb9e37d226",
    "timestamp": "2025-06-26T08:37:09.481Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is None\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_SjfK2nd6vq4J2i7ppYZzR7RV\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 151,
      "completion": 15
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is None"
      },
      {
        "role": "user",
        "content": "What is my balance?"
      }
    ]
  },
  {
    "type": "llm",
    "event": "end",
    "runId": "9ea1375e-47fc-46e2-b8d1-d00d1bc383a9",
    "parentRunId": "bff9cc64-abb2-4312-b51d-9beb9e37d226",
    "timestamp": "2025-06-26T08:37:10.212Z",
    "metadata": {
      "system": "openai",
      "server.address": "api.openai.com",
      "model_request_parameters": "{\"function_tools\": [{\"name\": \"customer_balance\", \"description\": \"Returns the customer's current account balance.\", \"parameters_json_schema\": {\"additionalProperties\": false, \"properties\": {\"include_pending\": {\"type\": \"boolean\"}}, \"required\": [\"include_pending\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": true}], \"output_mode\": \"tool\", \"output_object\": null, \"output_tools\": [{\"name\": \"final_result\", \"description\": \"The final response which ends this conversation\", \"parameters_json_schema\": {\"properties\": {\"support_advice\": {\"description\": \"Advice returned to the customer\", \"type\": \"string\"}, \"block_card\": {\"description\": \"Whether to block their card or not\", \"type\": \"boolean\"}, \"risk\": {\"description\": \"Risk level of query\", \"maximum\": 10, \"minimum\": 0, \"type\": \"integer\"}}, \"required\": [\"support_advice\", \"block_card\", \"risk\"], \"type\": \"object\"}, \"outer_typed_dict_key\": null, \"strict\": false}], \"allow_text_output\": false}",
      "logfire_span_type": "span",
      "logfire_msg": "chat gpt-4o",
      "modelResponse": "gpt-4o-2024-08-06",
      "events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is None\", \"role\": \"system\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.system\": \"openai\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"index\": 0, \"message\": {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_SjfK2nd6vq4J2i7ppYZzR7RV\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}]}, \"gen_ai.system\": \"openai\", \"event.name\": \"gen_ai.choice\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"events\": {\"type\": \"array\"}, \"model_request_parameters\": {\"type\": \"object\"}}}",
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 731.284
    },
    "params": {
      "model": "gpt-4o"
    },
    "name": "gpt-4o",
    "tokensUsage": {
      "prompt": 151,
      "completion": 15
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_SjfK2nd6vq4J2i7ppYZzR7RV",
            "type": "function",
            "function": {
              "name": "customer_balance",
              "arguments": "{\"include_pending\":true}"
            }
          }
        ]
      }
    ]
  },
  {
    "type": "tool",
    "event": "start",
    "runId": "9af9d1c6-32f4-4868-9731-a863cb24158b",
    "parentRunId": "bff9cc64-abb2-4312-b51d-9beb9e37d226",
    "timestamp": "2025-06-26T08:37:10.213Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_SjfK2nd6vq4J2i7ppYZzR7RV",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "logfire_level_num": 17,
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "input": {
      "include_pending": true
    }
  },
  {
    "type": "tool",
    "event": "end",
    "runId": "9af9d1c6-32f4-4868-9731-a863cb24158b",
    "parentRunId": "bff9cc64-abb2-4312-b51d-9beb9e37d226",
    "timestamp": "2025-06-26T08:37:10.216Z",
    "metadata": {
      "toolName": "customer_balance",
      "toolCallId": "call_SjfK2nd6vq4J2i7ppYZzR7RV",
      "tool_arguments": "{\"include_pending\":true}",
      "logfire_msg": "running tool: customer_balance",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"tool_arguments\": {\"type\": \"object\"}, \"gen_ai.tool.name\": {}, \"gen_ai.tool.call.id\": {}}}",
      "logfire_span_type": "span",
      "logfire_level_num": 17,
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 3.907
    },
    "output": "Tool executed successfully",
    "level": "error",
    "error": {
      "code": 2,
      "message": "ValueError: Customer not found"
    }
  },
  {
    "type": "agent",
    "event": "start",
    "runId": "bff9cc64-abb2-4312-b51d-9beb9e37d226",
    "timestamp": "2025-06-26T08:37:09.480Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is None\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_SjfK2nd6vq4J2i7ppYZzR7RV\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "logfire_level_num": 17,
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b"
    },
    "tokensUsage": {
      "prompt": 151,
      "completion": 15
    },
    "input": [
      {
        "role": "system",
        "content": "You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name."
      },
      {
        "role": "system",
        "content": "The customer's name is None"
      },
      {
        "role": "user",
        "content": "What is my balance?"
      }
    ]
  },
  {
    "type": "agent",
    "event": "end",
    "runId": "bff9cc64-abb2-4312-b51d-9beb9e37d226",
    "timestamp": "2025-06-26T08:37:10.222Z",
    "metadata": {
      "model_name": "gpt-4o",
      "agent_name": "support_agent",
      "logfire_msg": "support_agent run",
      "logfire_span_type": "span",
      "all_messages_events": "[{\"content\": \"You are a support agent in our bank, give the customer support and judge the risk level of their query. Reply using the customer's name.\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"The customer's name is None\", \"role\": \"system\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.system.message\"}, {\"content\": \"What is my balance?\", \"role\": \"user\", \"gen_ai.message.index\": 0, \"event.name\": \"gen_ai.user.message\"}, {\"role\": \"assistant\", \"tool_calls\": [{\"id\": \"call_SjfK2nd6vq4J2i7ppYZzR7RV\", \"type\": \"function\", \"function\": {\"name\": \"customer_balance\", \"arguments\": \"{\\\"include_pending\\\":true}\"}}], \"gen_ai.message.index\": 1, \"event.name\": \"gen_ai.assistant.message\"}]",
      "logfire_json_schema": "{\"type\": \"object\", \"properties\": {\"all_messages_events\": {\"type\": \"array\"}, \"final_result\": {\"type\": \"object\"}}}",
      "logfire_level_num": 17,
      "service.instance.id": "b971d9b758f343c29d02f92bbf2a802b",
      "telemetry.sdk.language": "python",
      "telemetry.sdk.name": "opentelemetry",
      "telemetry.sdk.version": "1.34.1",
      "service.name": "lunary-bank-support",
      "process.pid": 25101,
      "process.runtime.name": "cpython",
      "process.runtime.version": "3.13.5",
      "process.runtime.description": "3.13.5 (main, Jun 11 2025, 15:36:57) [Clang 17.0.0 (clang-1700.0.13.3)]",
      "service.version": "c44dccd6726acda306348e533968b0e7aef2137b",
      "duration_ms": 742.335
    },
    "tokensUsage": {
      "prompt": 151,
      "completion": 15
    },
    "output": [
      {
        "role": "assistant",
        "tool_calls": [
          {
            "id": "call_SjfK2nd6vq4J2i7ppYZzR7RV",
            "type": "function",
            "function": {
              "name": "customer_balance",
              "arguments": "{\"include_pending\":true}"
            }
          }
        ]
      }
    ],
    "level": "error",
    "error": {
      "code": 2,
      "message": "ValueError: Customer not found"
    }
  }
]
Using project key: 07ff18c9-f052-4260-9e89-ea93fe9ba8c5
âœ… Successfully forwarded to backend
ðŸ“Š metrics: 1 ResourceMetrics
